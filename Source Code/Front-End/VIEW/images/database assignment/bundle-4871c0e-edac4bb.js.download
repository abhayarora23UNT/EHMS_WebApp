(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}(g.braintree||(g.braintree={})).client=f()}})(function(){var define,module,exports;return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(_dereq_,module,exports){(function(global){"use strict";var PromisePolyfill=_dereq_("promise-polyfill");module.exports=global.Promise||PromisePolyfill}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"promise-polyfill":10}],2:[function(_dereq_,module,exports){"use strict";var Promise=_dereq_("./lib/promise");var scriptPromiseCache={};function loadScript(options){var attrs,container,script,scriptLoadPromise;var stringifiedOptions=JSON.stringify(options);if(!options.forceScriptReload){scriptLoadPromise=scriptPromiseCache[stringifiedOptions];if(scriptLoadPromise){return scriptLoadPromise}}script=document.createElement("script");attrs=options.dataAttributes||{};container=options.container||document.head;script.src=options.src;script.id=options.id;script.async=true;Object.keys(attrs).forEach(function(key){script.setAttribute("data-"+key,attrs[key])});scriptLoadPromise=new Promise(function(resolve,reject){script.addEventListener("load",function(){resolve(script)});script.addEventListener("error",function(){reject(new Error(options.src+" failed to load."))});script.addEventListener("abort",function(){reject(new Error(options.src+" has aborted."))});container.appendChild(script)});scriptPromiseCache[stringifiedOptions]=scriptLoadPromise;return scriptLoadPromise}loadScript.clearCache=function(){scriptPromiseCache={}};module.exports=loadScript},{"./lib/promise":1}],3:[function(_dereq_,module,exports){(function(global){"use strict";var isIE11=_dereq_("./is-ie11");module.exports=function isIE(ua){ua=ua||global.navigator.userAgent;return ua.indexOf("MSIE")!==-1||isIE11(ua)}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./is-ie11":4}],4:[function(_dereq_,module,exports){"use strict";module.exports=function isIe11(ua){ua=ua||navigator.userAgent;return ua.indexOf("Trident/7")!==-1}},{}],5:[function(_dereq_,module,exports){"use strict";module.exports=function isIe9(ua){ua=ua||navigator.userAgent;return ua.indexOf("MSIE 9")!==-1}},{}],6:[function(_dereq_,module,exports){"use strict";function deferred(fn){return function(){var args=arguments;setTimeout(function(){try{fn.apply(null,args)}catch(err){console.log("Error in callback function");console.log(err)}},1)}}module.exports=deferred},{}],7:[function(_dereq_,module,exports){"use strict";function once(fn){var called=false;return function(){if(!called){called=true;fn.apply(null,arguments)}}}module.exports=once},{}],8:[function(_dereq_,module,exports){"use strict";function promiseOrCallback(promise,callback){if(callback){promise.then(function(data){callback(null,data)}).catch(function(err){callback(err)})}else{return promise}}module.exports=promiseOrCallback},{}],9:[function(_dereq_,module,exports){"use strict";var deferred=_dereq_("./lib/deferred");var once=_dereq_("./lib/once");var promiseOrCallback=_dereq_("./lib/promise-or-callback");function wrapPromise(fn){return function(){var callback;var args=Array.prototype.slice.call(arguments);var lastArg=args[args.length-1];if(typeof lastArg==="function"){callback=args.pop();callback=once(deferred(callback))}return promiseOrCallback(fn.apply(this,args),callback)}}wrapPromise.wrapPrototype=function(target,options){var methods,ignoreMethods,includePrivateMethods;options=options||{};ignoreMethods=options.ignoreMethods||[];includePrivateMethods=options.transformPrivateMethods===true;methods=Object.getOwnPropertyNames(target.prototype).filter(function(method){var isNotPrivateMethod;var isNonConstructorFunction=method!=="constructor"&&typeof target.prototype[method]==="function";var isNotAnIgnoredMethod=ignoreMethods.indexOf(method)===-1;if(includePrivateMethods){isNotPrivateMethod=true}else{isNotPrivateMethod=method.charAt(0)!=="_"}return isNonConstructorFunction&&isNotPrivateMethod&&isNotAnIgnoredMethod});methods.forEach(function(method){var original=target.prototype[method];target.prototype[method]=wrapPromise(original)});return target};module.exports=wrapPromise},{"./lib/deferred":6,"./lib/once":7,"./lib/promise-or-callback":8}],10:[function(_dereq_,module,exports){"use strict";function finallyConstructor(callback){var constructor=this.constructor;return this.then(function(value){return constructor.resolve(callback()).then(function(){return value})},function(reason){return constructor.resolve(callback()).then(function(){return constructor.reject(reason)})})}var setTimeoutFunc=setTimeout;function noop(){}function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function Promise(fn){if(!(this instanceof Promise))throw new TypeError("Promises must be constructed via new");if(typeof fn!=="function")throw new TypeError("not a function");this._state=0;this._handled=false;this._value=undefined;this._deferreds=[];doResolve(fn,this)}function handle(self,deferred){while(self._state===3){self=self._value}if(self._state===0){self._deferreds.push(deferred);return}self._handled=true;Promise._immediateFn(function(){var cb=self._state===1?deferred.onFulfilled:deferred.onRejected;if(cb===null){(self._state===1?resolve:reject)(deferred.promise,self._value);return}var ret;try{ret=cb(self._value)}catch(e){reject(deferred.promise,e);return}resolve(deferred.promise,ret)})}function resolve(self,newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&(typeof newValue==="object"||typeof newValue==="function")){var then=newValue.then;if(newValue instanceof Promise){self._state=3;self._value=newValue;finale(self);return}else if(typeof then==="function"){doResolve(bind(then,newValue),self);return}}self._state=1;self._value=newValue;finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2;self._value=newValue;finale(self)}function finale(self){if(self._state===2&&self._deferreds.length===0){Promise._immediateFn(function(){if(!self._handled){Promise._unhandledRejectionFn(self._value)}})}for(var i=0,len=self._deferreds.length;i<len;i++){handle(self,self._deferreds[i])}self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled=typeof onFulfilled==="function"?onFulfilled:null;this.onRejected=typeof onRejected==="function"?onRejected:null;this.promise=promise}function doResolve(fn,self){var done=false;try{fn(function(value){if(done)return;done=true;resolve(self,value)},function(reason){if(done)return;done=true;reject(self,reason)})}catch(ex){if(done)return;done=true;reject(self,ex)}}Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected)};Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);handle(this,new Handler(onFulfilled,onRejected,prom));return prom};Promise.prototype["finally"]=finallyConstructor;Promise.all=function(arr){return new Promise(function(resolve,reject){if(!arr||typeof arr.length==="undefined")throw new TypeError("Promise.all accepts an array");var args=Array.prototype.slice.call(arr);if(args.length===0)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&(typeof val==="object"||typeof val==="function")){var then=val.then;if(typeof then==="function"){then.call(val,function(val){res(i,val)},reject);return}}args[i]=val;if(--remaining===0){resolve(args)}}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++){res(i,args[i])}})};Promise.resolve=function(value){if(value&&typeof value==="object"&&value.constructor===Promise){return value}return new Promise(function(resolve){resolve(value)})};Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})};Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++){values[i].then(resolve,reject)}})};Promise._immediateFn=typeof setImmediate==="function"&&function(fn){setImmediate(fn)}||function(fn){setTimeoutFunc(fn,0)};Promise._unhandledRejectionFn=function _unhandledRejectionFn(err){if(typeof console!=="undefined"&&console){console.warn("Possible Unhandled Promise Rejection:",err)}};module.exports=Promise},{}],11:[function(_dereq_,module,exports){"use strict";var isIe=_dereq_("@braintree/browser-detection/is-ie");var isIe9=_dereq_("@braintree/browser-detection/is-ie9");module.exports={isIe:isIe,isIe9:isIe9}},{"@braintree/browser-detection/is-ie":3,"@braintree/browser-detection/is-ie9":5}],12:[function(_dereq_,module,exports){"use strict";var BRAINTREE_VERSION=_dereq_("./constants").BRAINTREE_VERSION;var GraphQL=_dereq_("./request/graphql");var request=_dereq_("./request");var isVerifiedDomain=_dereq_("../lib/is-verified-domain");var BraintreeError=_dereq_("../lib/braintree-error");var convertToBraintreeError=_dereq_("../lib/convert-to-braintree-error");var createAuthorizationData=_dereq_("../lib/create-authorization-data");var getGatewayConfiguration=_dereq_("./get-configuration").getConfiguration;var addMetadata=_dereq_("../lib/add-metadata");var Promise=_dereq_("../lib/promise");var wrapPromise=_dereq_("@braintree/wrap-promise");var once=_dereq_("../lib/once");var deferred=_dereq_("../lib/deferred");var assign=_dereq_("../lib/assign").assign;var analytics=_dereq_("../lib/analytics");var constants=_dereq_("./constants");var errors=_dereq_("./errors");var sharedErrors=_dereq_("../lib/errors");var VERSION=_dereq_("../lib/constants").VERSION;var GRAPHQL_URLS=_dereq_("../lib/constants").GRAPHQL_URLS;var methods=_dereq_("../lib/methods");var convertMethodsToError=_dereq_("../lib/convert-methods-to-error");var assets=_dereq_("../lib/assets");var FRAUDNET_FNCLS=_dereq_("../lib/constants").FRAUDNET_FNCLS;var FRAUDNET_SOURCE=_dereq_("../lib/constants").FRAUDNET_SOURCE;var FRAUDNET_URL=_dereq_("../lib/constants").FRAUDNET_URL;var cachedClients={};function Client(configuration){var configurationJSON,gatewayConfiguration,braintreeApiConfiguration;configuration=configuration||{};configurationJSON=JSON.stringify(configuration);gatewayConfiguration=configuration.gatewayConfiguration;if(!gatewayConfiguration){throw new BraintreeError(errors.CLIENT_MISSING_GATEWAY_CONFIGURATION)}["assetsUrl","clientApiUrl","configUrl"].forEach(function(property){if(property in gatewayConfiguration&&!isVerifiedDomain(gatewayConfiguration[property])){throw new BraintreeError({type:errors.CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN.type,code:errors.CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN.code,message:property+" property is on an invalid domain."})}});this.getConfiguration=function(){return JSON.parse(configurationJSON)};this._request=request;this._configuration=this.getConfiguration();this._clientApiBaseUrl=gatewayConfiguration.clientApiUrl+"/v1/";braintreeApiConfiguration=gatewayConfiguration.braintreeApi;if(braintreeApiConfiguration){this._braintreeApi={baseUrl:braintreeApiConfiguration.url+"/",accessToken:braintreeApiConfiguration.accessToken};if(!isVerifiedDomain(this._braintreeApi.baseUrl)){throw new BraintreeError({type:errors.CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN.type,code:errors.CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN.code,message:"braintreeApi URL is on an invalid domain."})}}if(gatewayConfiguration.graphQL){this._graphQL=new GraphQL({graphQL:gatewayConfiguration.graphQL})}}Client.initialize=function(options){var clientInstance;var promise=cachedClients[options.authorization];if(promise){analytics.sendEvent(promise,"custom.client.load.cached");return promise}promise=getGatewayConfiguration(options).then(function(configuration){if(options.debug){configuration.isDebug=true}clientInstance=new Client(configuration);return clientInstance});cachedClients[options.authorization]=promise;analytics.sendEvent(promise,"custom.client.load.initialized");return promise.then(function(client){analytics.sendEvent(clientInstance,"custom.client.load.succeeded");return client}).catch(function(err){delete cachedClients[options.authorization];return Promise.reject(err)})};Client.clearCache=function(){cachedClients={}};Client.prototype._findOrCreateFraudnetJSON=function(clientMetadataId){var el=document.querySelector('script[fncls="'+FRAUDNET_FNCLS+'"]');var config,additionalData,authorizationFingerprint,parameters;if(!el){el=document.body.appendChild(document.createElement("script"));el.type="application/json";el.setAttribute("fncls",FRAUDNET_FNCLS)}config=this.getConfiguration();additionalData={rda_tenant:"bt_card",mid:config.gatewayConfiguration.merchantId};authorizationFingerprint=createAuthorizationData(config.authorization).attrs.authorizationFingerprint;if(authorizationFingerprint){authorizationFingerprint.split("&").forEach(function(pieces){var component=pieces.split("=");if(component[0]==="customer_id"&&component.length>1){additionalData.cid=component[1]}})}parameters={f:clientMetadataId.substr(0,32),fp:additionalData,bu:false,s:FRAUDNET_SOURCE};el.text=JSON.stringify(parameters)};Client.prototype.request=function(options,callback){var self=this;var requestPromise=new Promise(function(resolve,reject){var optionName,api,baseUrl,requestOptions;var shouldCollectData=Boolean(options.endpoint==="payment_methods/credit_cards"&&self.getConfiguration().gatewayConfiguration.creditCards.collectDeviceData);if(options.api!=="graphQLApi"){if(!options.method){optionName="options.method"}else if(!options.endpoint){optionName="options.endpoint"}}if(optionName){throw new BraintreeError({type:errors.CLIENT_OPTION_REQUIRED.type,code:errors.CLIENT_OPTION_REQUIRED.code,message:optionName+" is required when making a request."})}if("api"in options){api=options.api}else{api="clientApi"}requestOptions={method:options.method,graphQL:self._graphQL,timeout:options.timeout,metadata:self._configuration.analyticsMetadata};if(api==="clientApi"){baseUrl=self._clientApiBaseUrl;requestOptions.data=addMetadata(self._configuration,options.data)}else if(api==="braintreeApi"){if(!self._braintreeApi){throw new BraintreeError(sharedErrors.BRAINTREE_API_ACCESS_RESTRICTED)}baseUrl=self._braintreeApi.baseUrl;requestOptions.data=options.data;requestOptions.headers={"Braintree-Version":constants.BRAINTREE_API_VERSION_HEADER,Authorization:"Bearer "+self._braintreeApi.accessToken}}else if(api==="graphQLApi"){baseUrl=GRAPHQL_URLS[self._configuration.gatewayConfiguration.environment];options.endpoint="";requestOptions.method="post";requestOptions.data=assign({clientSdkMetadata:{source:self._configuration.analyticsMetadata.source,integration:self._configuration.analyticsMetadata.integration,sessionId:self._configuration.analyticsMetadata.sessionId}},options.data);requestOptions.headers=getAuthorizationHeadersForGraphQL(self._configuration.authorization)}else{throw new BraintreeError({type:errors.CLIENT_OPTION_INVALID.type,code:errors.CLIENT_OPTION_INVALID.code,message:"options.api is invalid."})}requestOptions.url=baseUrl+options.endpoint;requestOptions.sendAnalyticsEvent=function(kind){analytics.sendEvent(self,kind)};self._request(requestOptions,function(err,data,status){var resolvedData,requestError;requestError=formatRequestError(status,err);if(requestError){reject(requestError);return}if(api==="graphQLApi"&&data.errors){reject(convertToBraintreeError(data.errors,{type:errors.CLIENT_GRAPHQL_REQUEST_ERROR.type,code:errors.CLIENT_GRAPHQL_REQUEST_ERROR.code,message:errors.CLIENT_GRAPHQL_REQUEST_ERROR.message}));return}resolvedData=assign({_httpStatus:status},data);if(shouldCollectData&&resolvedData.creditCards&&resolvedData.creditCards.length>0){self._findOrCreateFraudnetJSON(resolvedData.creditCards[0].nonce);assets.loadScript({src:FRAUDNET_URL,forceScriptReload:true})}resolve(resolvedData)})});if(typeof callback==="function"){callback=once(deferred(callback));requestPromise.then(function(response){callback(null,response,response._httpStatus)}).catch(function(err){var status=err&&err.details&&err.details.httpStatus;callback(err,null,status)});return}return requestPromise};function formatRequestError(status,err){var requestError;if(status===-1){requestError=new BraintreeError(errors.CLIENT_REQUEST_TIMEOUT)}else if(status===403){requestError=new BraintreeError(errors.CLIENT_AUTHORIZATION_INSUFFICIENT)}else if(status===429){requestError=new BraintreeError(errors.CLIENT_RATE_LIMITED)}else if(status>=500){requestError=new BraintreeError(errors.CLIENT_GATEWAY_NETWORK)}else if(status<200||status>=400){requestError=convertToBraintreeError(err,{type:errors.CLIENT_REQUEST_ERROR.type,code:errors.CLIENT_REQUEST_ERROR.code,message:errors.CLIENT_REQUEST_ERROR.message})}if(requestError){requestError.details=requestError.details||{};requestError.details.httpStatus=status;return requestError}}Client.prototype.toJSON=function(){return this.getConfiguration()};Client.prototype.getVersion=function(){return VERSION};Client.prototype.teardown=wrapPromise(function(){var self=this;delete cachedClients[self.getConfiguration().authorization];convertMethodsToError(self,methods(Client.prototype));return Promise.resolve()});function getAuthorizationHeadersForGraphQL(authorization){var authAttrs=createAuthorizationData(authorization).attrs;var token=authAttrs.authorizationFingerprint||authAttrs.tokenizationKey;return{Authorization:"Bearer "+token,"Braintree-Version":BRAINTREE_VERSION}}module.exports=Client},{"../lib/add-metadata":33,"../lib/analytics":34,"../lib/assets":35,"../lib/assign":36,"../lib/braintree-error":37,"../lib/constants":38,"../lib/convert-methods-to-error":39,"../lib/convert-to-braintree-error":40,"../lib/create-authorization-data":41,"../lib/deferred":42,"../lib/errors":44,"../lib/is-verified-domain":46,"../lib/methods":48,"../lib/once":49,"../lib/promise":50,"./constants":13,"./errors":14,"./get-configuration":15,"./request":27,"./request/graphql":25,"@braintree/wrap-promise":9}],13:[function(_dereq_,module,exports){"use strict";module.exports={BRAINTREE_API_VERSION_HEADER:"2017-04-03",BRAINTREE_VERSION:"2018-05-10"}},{}],14:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("../lib/braintree-error");module.exports={CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN:{type:BraintreeError.types.MERCHANT,code:"CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN"},CLIENT_OPTION_REQUIRED:{type:BraintreeError.types.MERCHANT,code:"CLIENT_OPTION_REQUIRED"},CLIENT_OPTION_INVALID:{type:BraintreeError.types.MERCHANT,code:"CLIENT_OPTION_INVALID"},CLIENT_MISSING_GATEWAY_CONFIGURATION:{type:BraintreeError.types.INTERNAL,code:"CLIENT_MISSING_GATEWAY_CONFIGURATION",message:"Missing gatewayConfiguration."},CLIENT_INVALID_AUTHORIZATION:{type:BraintreeError.types.MERCHANT,code:"CLIENT_INVALID_AUTHORIZATION",message:"Authorization is invalid. Make sure your client token or tokenization key is valid."},CLIENT_GATEWAY_NETWORK:{type:BraintreeError.types.NETWORK,code:"CLIENT_GATEWAY_NETWORK",message:"Cannot contact the gateway at this time."},CLIENT_REQUEST_TIMEOUT:{type:BraintreeError.types.NETWORK,code:"CLIENT_REQUEST_TIMEOUT",message:"Request timed out waiting for a reply."},CLIENT_REQUEST_ERROR:{type:BraintreeError.types.NETWORK,code:"CLIENT_REQUEST_ERROR",message:"There was a problem with your request."},CLIENT_GRAPHQL_REQUEST_ERROR:{type:BraintreeError.types.NETWORK,code:"CLIENT_GRAPHQL_REQUEST_ERROR",message:"There was a problem with your request."},CLIENT_RATE_LIMITED:{type:BraintreeError.types.MERCHANT,code:"CLIENT_RATE_LIMITED",message:"You are being rate-limited; please try again in a few minutes."},CLIENT_AUTHORIZATION_INSUFFICIENT:{type:BraintreeError.types.MERCHANT,code:"CLIENT_AUTHORIZATION_INSUFFICIENT",message:"The authorization used has insufficient privileges."}}},{"../lib/braintree-error":37}],15:[function(_dereq_,module,exports){(function(global){"use strict";var BraintreeError=_dereq_("../lib/braintree-error");var Promise=_dereq_("../lib/promise");var wrapPromise=_dereq_("@braintree/wrap-promise");var request=_dereq_("./request");var uuid=_dereq_("../lib/vendor/uuid");var constants=_dereq_("../lib/constants");var createAuthorizationData=_dereq_("../lib/create-authorization-data");var errors=_dereq_("./errors");var GraphQL=_dereq_("./request/graphql");var isDateStringBeforeOrOn=_dereq_("../lib/is-date-string-before-or-on");var BRAINTREE_VERSION=_dereq_("./constants").BRAINTREE_VERSION;function getConfiguration(options){return new Promise(function(resolve,reject){var configuration,authData,attrs,configUrl,reqOptions;var sessionId=uuid();var analyticsMetadata={merchantAppId:global.location.host,platform:constants.PLATFORM,sdkVersion:constants.VERSION,source:constants.SOURCE,integration:constants.INTEGRATION,integrationType:constants.INTEGRATION,sessionId:sessionId};try{authData=createAuthorizationData(options.authorization)}catch(err){reject(new BraintreeError(errors.CLIENT_INVALID_AUTHORIZATION));return}attrs=authData.attrs;configUrl=authData.configUrl;attrs._meta=analyticsMetadata;attrs.braintreeLibraryVersion=constants.BRAINTREE_LIBRARY_VERSION;attrs.configVersion="3";reqOptions={url:configUrl,method:"GET",data:attrs};if(attrs.authorizationFingerprint&&authData.graphQL){if(isDateStringBeforeOrOn(authData.graphQL.date,BRAINTREE_VERSION)){reqOptions.graphQL=new GraphQL({graphQL:{url:authData.graphQL.url,features:["configuration"]}})}reqOptions.metadata=analyticsMetadata}request(reqOptions,function(err,response,status){var errorTemplate;if(err){if(status===403){errorTemplate=errors.CLIENT_AUTHORIZATION_INSUFFICIENT}else{errorTemplate=errors.CLIENT_GATEWAY_NETWORK}reject(new BraintreeError({type:errorTemplate.type,code:errorTemplate.code,message:errorTemplate.message,details:{originalError:err}}));return}configuration={authorization:options.authorization,authorizationType:attrs.tokenizationKey?"TOKENIZATION_KEY":"CLIENT_TOKEN",analyticsMetadata:analyticsMetadata,gatewayConfiguration:response};resolve(configuration)})})}module.exports={getConfiguration:wrapPromise(getConfiguration)}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../lib/braintree-error":37,"../lib/constants":38,"../lib/create-authorization-data":41,"../lib/is-date-string-before-or-on":45,"../lib/promise":50,"../lib/vendor/uuid":53,"./constants":13,"./errors":14,"./request":27,"./request/graphql":25,"@braintree/wrap-promise":9}],16:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("../lib/braintree-error");var Client=_dereq_("./client");var VERSION="3.45.0";var Promise=_dereq_("../lib/promise");var wrapPromise=_dereq_("@braintree/wrap-promise");var sharedErrors=_dereq_("../lib/errors");function create(options){if(!options.authorization){return Promise.reject(new BraintreeError({type:sharedErrors.INSTANTIATION_OPTION_REQUIRED.type,code:sharedErrors.INSTANTIATION_OPTION_REQUIRED.code,message:"options.authorization is required when instantiating a client."}))}return Client.initialize(options)}module.exports={create:wrapPromise(create),VERSION:VERSION}},{"../lib/braintree-error":37,"../lib/errors":44,"../lib/promise":50,"./client":12,"@braintree/wrap-promise":9}],17:[function(_dereq_,module,exports){"use strict";var querystring=_dereq_("../../lib/querystring");var browserDetection=_dereq_("../browser-detection");var assign=_dereq_("../../lib/assign").assign;var prepBody=_dereq_("./prep-body");var parseBody=_dereq_("./parse-body");var xhr=_dereq_("./xhr");var isXHRAvailable=xhr.isAvailable;var GraphQLRequest=_dereq_("./graphql/request");var DefaultRequest=_dereq_("./default-request");var MAX_TCP_RETRYCOUNT=1;var TCP_PRECONNECT_BUG_STATUS_CODE=408;function requestShouldRetry(status){return(!status||status===TCP_PRECONNECT_BUG_STATUS_CODE)&&browserDetection.isIe()}function graphQLRequestShouldRetryWithClientApi(body){var errorClass=!body.data&&body.errors&&body.errors[0]&&body.errors[0].extensions&&body.errors[0].extensions.errorClass;return errorClass==="UNKNOWN"||errorClass==="INTERNAL"}function _requestWithRetry(options,tcpRetryCount,cb){var status,resBody,ajaxRequest,body,method,headers,parsedBody;var url=options.url;var graphQL=options.graphQL;var timeout=options.timeout;var req=xhr.getRequestObject();var callback=cb;var isGraphQLRequest=Boolean(graphQL&&graphQL.isGraphQLRequest(url,options.data));options.headers=assign({"Content-Type":"application/json"},options.headers);if(isGraphQLRequest){ajaxRequest=new GraphQLRequest(options)}else{ajaxRequest=new DefaultRequest(options)}url=ajaxRequest.getUrl();body=ajaxRequest.getBody();method=ajaxRequest.getMethod();headers=ajaxRequest.getHeaders();if(method==="GET"){url=querystring.queryify(url,body);body=null}if(isXHRAvailable){req.onreadystatechange=function(){if(req.readyState!==4){return}if(req.status===0&&isGraphQLRequest){delete options.graphQL;_requestWithRetry(options,tcpRetryCount,cb);return}parsedBody=parseBody(req.responseText);resBody=ajaxRequest.adaptResponseBody(parsedBody);status=ajaxRequest.determineStatus(req.status,parsedBody);if(status>=400||status<200){if(isGraphQLRequest&&graphQLRequestShouldRetryWithClientApi(parsedBody)){delete options.graphQL;_requestWithRetry(options,tcpRetryCount,cb);return}if(tcpRetryCount<MAX_TCP_RETRYCOUNT&&requestShouldRetry(status)){tcpRetryCount++;_requestWithRetry(options,tcpRetryCount,cb);return}callback(resBody||"error",null,status||500)}else{callback(null,resBody,status)}}}else{if(options.headers){url=querystring.queryify(url,headers)}req.onload=function(){callback(null,parseBody(req.responseText),req.status)};req.onerror=function(){callback("error",null,500)};req.onprogress=function(){};req.ontimeout=function(){callback("timeout",null,-1)}}try{req.open(method,url,true)}catch(requestOpenError){if(!isGraphQLRequest){throw requestOpenError}delete options.graphQL;_requestWithRetry(options,tcpRetryCount,cb);return}req.timeout=timeout;if(isXHRAvailable){Object.keys(headers).forEach(function(headerKey){req.setRequestHeader(headerKey,headers[headerKey])})}try{req.send(prepBody(method,body))}catch(e){}}function request(options,cb){_requestWithRetry(options,0,cb)}module.exports={request:request}},{"../../lib/assign":36,"../../lib/querystring":51,"../browser-detection":11,"./default-request":18,"./graphql/request":26,"./parse-body":30,"./prep-body":31,"./xhr":32}],18:[function(_dereq_,module,exports){"use strict";function DefaultRequest(options){this._url=options.url;this._data=options.data;this._method=options.method;this._headers=options.headers}DefaultRequest.prototype.getUrl=function(){return this._url};DefaultRequest.prototype.getBody=function(){return this._data};DefaultRequest.prototype.getMethod=function(){return this._method};DefaultRequest.prototype.getHeaders=function(){return this._headers};DefaultRequest.prototype.adaptResponseBody=function(parsedBody){return parsedBody};DefaultRequest.prototype.determineStatus=function(status){return status};module.exports=DefaultRequest},{}],19:[function(_dereq_,module,exports){(function(global){"use strict";module.exports=function getUserAgent(){return global.navigator.userAgent}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],20:[function(_dereq_,module,exports){"use strict";var errorResponseAdapter=_dereq_("./error");var assign=_dereq_("../../../../lib/assign").assign;var cardTypeTransforms={creditCard:{AMERICAN_EXPRESS:"American Express",DISCOVER:"Discover",INTERNATIONAL_MAESTRO:"Maestro",JCB:"JCB",MASTERCARD:"MasterCard",SOLO:"Solo",UK_MAESTRO:"UK Maestro",UNION_PAY:"UnionPay",VISA:"Visa"},applePayWeb:{VISA:"visa",MASTERCARD:"mastercard",DISCOVER:"discover",AMERICAN_EXPRESS:"amex"},visaCheckout:{VISA:"Visa",MASTERCARD:"MasterCard",DISCOVER:"Discover",AMERICAN_EXPRESS:"American Express"},googlePay:{VISA:"visa",MASTERCARD:"mastercard",DISCOVER:"discover",AMERICAN_EXPRESS:"amex"},masterpass:{VISA:"visa",MASTERCARD:"master",DISCOVER:"discover",AMERICAN_EXPRESS:"amex",DINERS:"diners",INTERNATIONAL_MAESTRO:"maestro",JCB:"jcb"}};function configurationResponseAdapter(responseBody,ctx){var adaptedResponse;if(responseBody.data&&!responseBody.errors){adaptedResponse=adaptConfigurationResponseBody(responseBody,ctx)}else{adaptedResponse=errorResponseAdapter(responseBody)}return adaptedResponse}function adaptConfigurationResponseBody(body,ctx){var configuration=body.data.clientConfiguration;var response;response={environment:configuration.environment.toLowerCase(),clientApiUrl:configuration.clientApiUrl,assetsUrl:configuration.assetsUrl,analytics:{url:configuration.analyticsUrl},merchantId:configuration.merchantId,venmo:"off"};if(configuration.supportedFeatures){response.graphQL={url:ctx._graphQL._config.url,features:configuration.supportedFeatures.map(function(feature){return feature.toLowerCase()})}}if(configuration.braintreeApi){response.braintreeApi=configuration.braintreeApi}if(configuration.applePayWeb){response.applePayWeb=configuration.applePayWeb;response.applePayWeb.supportedNetworks=mapCardTypes(configuration.applePayWeb.supportedCardBrands,cardTypeTransforms.applePayWeb);delete response.applePayWeb.supportedCardBrands}if(configuration.ideal){response.ideal=configuration.ideal}if(configuration.kount){response.kount={kountMerchantId:configuration.kount.merchantId}}if(configuration.creditCard){response.challenges=configuration.creditCard.challenges.map(function(challenge){return challenge.toLowerCase()});response.creditCards={supportedCardTypes:mapCardTypes(configuration.creditCard.supportedCardBrands,cardTypeTransforms.creditCard)};response.threeDSecureEnabled=configuration.creditCard.threeDSecureEnabled}else{response.challenges=[];response.creditCards={supportedCardTypes:[]};response.threeDSecureEnabled=false}if(configuration.googlePay){response.androidPay={displayName:configuration.googlePay.displayName,enabled:true,environment:configuration.googlePay.environment.toLowerCase(),googleAuthorizationFingerprint:configuration.googlePay.googleAuthorization,supportedNetworks:mapCardTypes(configuration.googlePay.supportedCardBrands,cardTypeTransforms.googlePay)}}if(configuration.venmo){response.payWithVenmo={merchantId:configuration.venmo.merchantId,accessToken:configuration.venmo.accessToken,environment:configuration.venmo.environment.toLowerCase()}}if(configuration.paypal){response.paypalEnabled=true;response.paypal=assign({},configuration.paypal);response.paypal.currencyIsoCode=response.paypal.currencyCode;response.paypal.environment=response.paypal.environment.toLowerCase();delete response.paypal.currencyCode}else{response.paypalEnabled=false}if(configuration.unionPay){response.unionPay={enabled:true,merchantAccountId:configuration.unionPay.merchantAccountId}}if(configuration.visaCheckout){response.visaCheckout={apikey:configuration.visaCheckout.apiKey,externalClientId:configuration.visaCheckout.externalClientId,supportedCardTypes:mapCardTypes(configuration.visaCheckout.supportedCardBrands,cardTypeTransforms.visaCheckout)}}if(configuration.masterpass){response.masterpass={merchantCheckoutId:configuration.masterpass.merchantCheckoutId,supportedNetworks:mapCardTypes(configuration.masterpass.supportedCardBrands,cardTypeTransforms.masterpass)}}if(configuration.usBankAccount){response.usBankAccount={routeId:configuration.usBankAccount.routeId,plaid:{publicKey:configuration.usBankAccount.plaidPublicKey}}}return response}function mapCardTypes(cardTypes,cardTypeTransformMap){return cardTypes.reduce(function(acc,type){if(cardTypeTransformMap.hasOwnProperty(type)){return acc.concat(cardTypeTransformMap[type])}return acc},[])}module.exports=configurationResponseAdapter},{"../../../../lib/assign":36,"./error":22}],21:[function(_dereq_,module,exports){"use strict";var errorResponseAdapter=_dereq_("./error");var CARD_BRAND_MAP={AMERICAN_EXPRESS:"American Express",DINERS:"Discover",DISCOVER:"Discover",INTERNATIONAL_MAESTRO:"Maestro",JCB:"JCB",MASTERCARD:"MasterCard",UK_MAESTRO:"Maestro",UNION_PAY:"Union Pay",VISA:"Visa"};var BIN_DATA_MAP={YES:"Yes",NO:"No",UNKNOWN:"Unknown"};function creditCardTokenizationResponseAdapter(responseBody){var adaptedResponse;if(responseBody.data&&!responseBody.errors){adaptedResponse=adaptTokenizeCreditCardResponseBody(responseBody)}else{adaptedResponse=errorResponseAdapter(responseBody)}return adaptedResponse}function adaptTokenizeCreditCardResponseBody(body){var data=body.data.tokenizeCreditCard;var creditCard=data.creditCard;var lastTwo=creditCard.last4?creditCard.last4.substr(2,4):"";var binData=creditCard.binData;var response;if(binData){["commercial","debit","durbinRegulated","healthcare","payroll","prepaid"].forEach(function(key){if(binData[key]){binData[key]=BIN_DATA_MAP[binData[key]]}else{binData[key]="Unknown"}});["issuingBank","countryOfIssuance","productId"].forEach(function(key){if(!binData[key]){binData[key]="Unknown"}})}response={creditCards:[{binData:binData,consumed:false,description:lastTwo?"ending in "+lastTwo:"",nonce:data.token,details:{bin:creditCard.bin||"",cardType:CARD_BRAND_MAP[creditCard.brandCode]||"Unknown",lastFour:creditCard.last4||"",lastTwo:lastTwo},type:"CreditCard",threeDSecureInfo:null}]};return response}module.exports=creditCardTokenizationResponseAdapter},{"./error":22}],22:[function(_dereq_,module,exports){"use strict";function errorResponseAdapter(responseBody){var response;var errorClass=responseBody.errors&&responseBody.errors[0]&&responseBody.errors[0].extensions&&responseBody.errors[0].extensions.errorClass;if(errorClass==="VALIDATION"){response=userErrorResponseAdapter(responseBody)}else if(errorClass){response=errorWithClassResponseAdapter(responseBody)}else{response={error:{message:"There was a problem serving your request"},fieldErrors:[]}}return response}function errorWithClassResponseAdapter(responseBody){return{error:{message:responseBody.errors[0].message},fieldErrors:[]}}function userErrorResponseAdapter(responseBody){var fieldErrors=buildFieldErrors(responseBody.errors);return{error:{message:getLegacyMessage(fieldErrors)},fieldErrors:fieldErrors}}function buildFieldErrors(errors){var fieldErrors=[];errors.forEach(function(error){addFieldError(error.extensions.inputPath.slice(1),error,fieldErrors)});return fieldErrors}function addFieldError(inputPath,errorDetail,fieldErrors){var fieldError;var legacyCode=errorDetail.extensions.legacyCode;var inputField=inputPath[0];if(inputPath.length===1){fieldErrors.push({code:legacyCode,field:inputField,message:errorDetail.message});return}fieldErrors.forEach(function(candidate){if(candidate.field===inputField){fieldError=candidate}});if(!fieldError){fieldError={field:inputField,fieldErrors:[]};fieldErrors.push(fieldError)}addFieldError(inputPath.slice(1),errorDetail,fieldError.fieldErrors)}function getLegacyMessage(errors){var legacyMessages={creditCard:"Credit card is invalid"};var field=errors[0].field;return legacyMessages[field]}module.exports=errorResponseAdapter},{}],23:[function(_dereq_,module,exports){"use strict";var CONFIGURATION_QUERY="query ClientConfiguration { "+"  clientConfiguration { "+"    analyticsUrl "+"    environment "+"    merchantId "+"    assetsUrl "+"    clientApiUrl "+"    creditCard { "+"      supportedCardBrands "+"      challenges "+"      threeDSecureEnabled "+"    } "+"    applePayWeb { "+"      countryCode "+"      currencyCode "+"      merchantIdentifier "+"      supportedCardBrands "+"    } "+"    googlePay { "+"      displayName "+"      supportedCardBrands "+"      environment "+"      googleAuthorization "+"    } "+"    ideal { "+"      routeId "+"      assetsUrl "+"    } "+"    kount { "+"      merchantId "+"    } "+"    masterpass { "+"      merchantCheckoutId "+"      supportedCardBrands "+"    } "+"    paypal { "+"      displayName "+"      clientId "+"      privacyUrl "+"      userAgreementUrl "+"      assetsUrl "+"      environment "+"      environmentNoNetwork "+"      unvettedMerchant "+"      braintreeClientId "+"      billingAgreementsEnabled "+"      merchantAccountId "+"      currencyCode "+"      payeeEmail "+"    } "+"    unionPay { "+"      merchantAccountId "+"    } "+"    usBankAccount { "+"      routeId "+"      plaidPublicKey "+"    } "+"    venmo { "+"      merchantId "+"      accessToken "+"      environment "+"    } "+"    visaCheckout { "+"      apiKey "+"      externalClientId "+"      supportedCardBrands "+"    } "+"    braintreeApi { "+"      accessToken "+"      url "+"    } "+"    supportedFeatures "+"  } "+"}";function configuration(){return{query:CONFIGURATION_QUERY,operationName:"ClientConfiguration"}}module.exports=configuration},{}],24:[function(_dereq_,module,exports){"use strict";var assign=_dereq_("../../../../lib/assign").assign;var CREDIT_CARD_TOKENIZATION_MUTATION="mutation TokenizeCreditCard($input: TokenizeCreditCardInput!) { "+"  tokenizeCreditCard(input: $input) { "+"    token "+"    creditCard { "+"      bin "+"      brandCode "+"      last4 "+"      binData { "+"        prepaid "+"        healthcare "+"        debit "+"        durbinRegulated "+"        commercial "+"        payroll "+"        issuingBank "+"        countryOfIssuance "+"        productId "+"      } "+"    } "+"  } "+"}";function createCreditCardTokenizationBody(body){var cc=body.creditCard;var billingAddress=cc&&cc.billingAddress;var expDate=cc&&cc.expirationDate;var expirationMonth=cc&&(cc.expirationMonth||expDate&&expDate.split("/")[0].trim());var expirationYear=cc&&(cc.expirationYear||expDate&&expDate.split("/")[1].trim());var variables={input:{creditCard:{number:cc&&cc.number,expirationMonth:expirationMonth,expirationYear:expirationYear,cvv:cc&&cc.cvv,cardholderName:cc&&cc.cardholderName},options:{}}};if(billingAddress){variables.input.creditCard.billingAddress=billingAddress}variables.input=addValidationRule(body,variables.input);return variables}function addValidationRule(body,input){var validate;if(body.creditCard&&body.creditCard.options&&typeof body.creditCard.options.validate==="boolean"){validate=body.creditCard.options.validate}else if(body.authorizationFingerprint&&body.tokenizationKey||body.authorizationFingerprint){validate=true}else if(body.tokenizationKey){validate=false}if(typeof validate==="boolean"){input.options=assign({validate:validate},input.options)}return input}function creditCardTokenization(body){return{query:CREDIT_CARD_TOKENIZATION_MUTATION,variables:createCreditCardTokenizationBody(body),operationName:"TokenizeCreditCard"}}module.exports=creditCardTokenization},{"../../../../lib/assign":36}],25:[function(_dereq_,module,exports){"use strict";var browserDetection=_dereq_("../../browser-detection");var features={tokenize_credit_cards:"payment_methods/credit_cards",configuration:"configuration"};var disallowedInputPaths=["creditCard.options.unionPayEnrollment"];function GraphQL(config){this._config=config.graphQL}GraphQL.prototype.getGraphQLEndpoint=function(){return this._config.url};GraphQL.prototype.isGraphQLRequest=function(url,body){var featureEnabled;var path=this.getClientApiPath(url);if(!this._isGraphQLEnabled()||!path||browserDetection.isIe9()){return false}featureEnabled=this._config.features.some(function(feature){return features[feature]===path});if(containsDisallowedlistedKeys(body)){return false}return featureEnabled};GraphQL.prototype.getClientApiPath=function(url){var path;var clientApiPrefix="/client_api/v1/";var pathParts=url.split(clientApiPrefix);if(pathParts.length>1){path=pathParts[1].split("?")[0]}return path};GraphQL.prototype._isGraphQLEnabled=function(){return Boolean(this._config)};function containsDisallowedlistedKeys(body){return disallowedInputPaths.some(function(keys){var value=keys.split(".").reduce(function(accumulator,key){return accumulator&&accumulator[key]},body);return value!==undefined})}module.exports=GraphQL},{"../../browser-detection":11}],26:[function(_dereq_,module,exports){"use strict";var BRAINTREE_VERSION=_dereq_("../../constants").BRAINTREE_VERSION;var assign=_dereq_("../../../lib/assign").assign;var creditCardTokenizationBodyGenerator=_dereq_("./generators/credit-card-tokenization");var creditCardTokenizationResponseAdapter=_dereq_("./adapters/credit-card-tokenization");var configurationBodyGenerator=_dereq_("./generators/configuration");var configurationResponseAdapter=_dereq_("./adapters/configuration");var generators={"payment_methods/credit_cards":creditCardTokenizationBodyGenerator,configuration:configurationBodyGenerator};var adapters={"payment_methods/credit_cards":creditCardTokenizationResponseAdapter,configuration:configurationResponseAdapter};function GraphQLRequest(options){var clientApiPath=options.graphQL.getClientApiPath(options.url);this._graphQL=options.graphQL;this._data=options.data;this._method=options.method;this._headers=options.headers;this._clientSdkMetadata={source:options.metadata.source,integration:options.metadata.integration,sessionId:options.metadata.sessionId};this._sendAnalyticsEvent=options.sendAnalyticsEvent||Function.prototype;this._generator=generators[clientApiPath];this._adapter=adapters[clientApiPath];this._sendAnalyticsEvent("graphql.init")}GraphQLRequest.prototype.getUrl=function(){return this._graphQL.getGraphQLEndpoint()};GraphQLRequest.prototype.getBody=function(){var formattedBody=formatBodyKeys(this._data);var generatedBody=this._generator(formattedBody);var body=assign({clientSdkMetadata:this._clientSdkMetadata},generatedBody);return JSON.stringify(body)};GraphQLRequest.prototype.getMethod=function(){return"POST"};GraphQLRequest.prototype.getHeaders=function(){var authorization,headers;if(this._data.authorizationFingerprint){this._sendAnalyticsEvent("graphql.authorization-fingerprint");authorization=this._data.authorizationFingerprint}else{this._sendAnalyticsEvent("graphql.tokenization-key");authorization=this._data.tokenizationKey}headers={Authorization:"Bearer "+authorization,"Braintree-Version":BRAINTREE_VERSION};return assign({},this._headers,headers)};GraphQLRequest.prototype.adaptResponseBody=function(parsedBody){return this._adapter(parsedBody,this)};GraphQLRequest.prototype.determineStatus=function(httpStatus,parsedResponse){var status,errorClass;if(httpStatus===200){errorClass=parsedResponse.errors&&parsedResponse.errors[0]&&parsedResponse.errors[0].extensions&&parsedResponse.errors[0].extensions.errorClass;if(parsedResponse.data&&!parsedResponse.errors){status=200}else if(errorClass==="VALIDATION"){status=422}else if(errorClass==="AUTHORIZATION"){status=403}else if(errorClass==="AUTHENTICATION"){status=401}else if(isGraphQLError(errorClass,parsedResponse)){status=403}else{status=500}}else if(!httpStatus){status=500}else{status=httpStatus}this._sendAnalyticsEvent("graphql.status."+httpStatus);this._sendAnalyticsEvent("graphql.determinedStatus."+status);return status};function isGraphQLError(errorClass,parsedResponse){return!errorClass&&parsedResponse.errors[0].message}function snakeCaseToCamelCase(snakeString){if(snakeString.indexOf("_")===-1){return snakeString}return snakeString.toLowerCase().replace(/(\_\w)/g,function(match){return match[1].toUpperCase()})}function formatBodyKeys(originalBody){var body={};Object.keys(originalBody).forEach(function(key){var camelCaseKey=snakeCaseToCamelCase(key);if(typeof originalBody[key]==="object"){body[camelCaseKey]=formatBodyKeys(originalBody[key])}else if(typeof originalBody[key]==="number"){body[camelCaseKey]=String(originalBody[key])}else{body[camelCaseKey]=originalBody[key]}});return body}module.exports=GraphQLRequest},{"../../../lib/assign":36,"../../constants":13,"./adapters/configuration":20,"./adapters/credit-card-tokenization":21,"./generators/configuration":23,"./generators/credit-card-tokenization":24}],27:[function(_dereq_,module,exports){"use strict";var ajaxIsAvaliable;var once=_dereq_("../../lib/once");var JSONPDriver=_dereq_("./jsonp-driver");var AJAXDriver=_dereq_("./ajax-driver");var getUserAgent=_dereq_("./get-user-agent");var isHTTP=_dereq_("./is-http");function isAjaxAvailable(){if(ajaxIsAvaliable==null){ajaxIsAvaliable=!(isHTTP()&&/MSIE\s(8|9)/.test(getUserAgent()))}return ajaxIsAvaliable}module.exports=function(options,cb){cb=once(cb||Function.prototype);options.method=(options.method||"GET").toUpperCase();options.timeout=options.timeout==null?6e4:options.timeout;options.data=options.data||{};if(isAjaxAvailable()){AJAXDriver.request(options,cb)}else{JSONPDriver.request(options,cb)}}},{"../../lib/once":49,"./ajax-driver":17,"./get-user-agent":19,"./is-http":28,"./jsonp-driver":29}],28:[function(_dereq_,module,exports){(function(global){"use strict";module.exports=function(){return global.location.protocol==="http:"}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],29:[function(_dereq_,module,exports){(function(global){"use strict";var head;var uuid=_dereq_("../../lib/vendor/uuid");var querystring=_dereq_("../../lib/querystring");var timeouts={};function _removeScript(script){if(script&&script.parentNode){script.parentNode.removeChild(script)}}function _createScriptTag(url,callbackName){var script=document.createElement("script");var done=false;script.src=url;script.async=true;script.onerror=function(){global[callbackName]({message:"error",status:500})};script.onload=script.onreadystatechange=function(){if(done){return}if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){done=true;script.onload=script.onreadystatechange=null}};return script}function _cleanupGlobal(callbackName){try{delete global[callbackName]}catch(_){global[callbackName]=null}}function _setupTimeout(timeout,callbackName){timeouts[callbackName]=setTimeout(function(){timeouts[callbackName]=null;global[callbackName]({error:"timeout",status:-1});global[callbackName]=function(){_cleanupGlobal(callbackName)}},timeout)}function _setupGlobalCallback(script,callback,callbackName){global[callbackName]=function(response){var status=response.status||500;var err=null;var data=null;delete response.status;if(status>=400||status<200){err=response}else{data=response}_cleanupGlobal(callbackName);_removeScript(script);clearTimeout(timeouts[callbackName]);callback(err,data,status)}}function request(options,callback){var script;var callbackName="callback_json_"+uuid().replace(/-/g,"");var url=options.url;var attrs=options.data;var method=options.method;var timeout=options.timeout;url=querystring.queryify(url,attrs);url=querystring.queryify(url,{_method:method,callback:callbackName});script=_createScriptTag(url,callbackName);_setupGlobalCallback(script,callback,callbackName);_setupTimeout(timeout,callbackName);if(!head){head=document.getElementsByTagName("head")[0]}head.appendChild(script)}module.exports={request:request}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../lib/querystring":51,"../../lib/vendor/uuid":53}],30:[function(_dereq_,module,exports){"use strict";module.exports=function(body){try{body=JSON.parse(body)}catch(e){}return body}},{}],31:[function(_dereq_,module,exports){"use strict";module.exports=function(method,body){if(typeof method!=="string"){throw new Error("Method must be a string")}if(method.toLowerCase()!=="get"&&body!=null){body=typeof body==="string"?body:JSON.stringify(body)}return body}},{}],32:[function(_dereq_,module,exports){(function(global){"use strict";var isXHRAvailable=global.XMLHttpRequest&&"withCredentials"in new global.XMLHttpRequest;function getRequestObject(){return isXHRAvailable?new global.XMLHttpRequest:new global.XDomainRequest}module.exports={isAvailable:isXHRAvailable,getRequestObject:getRequestObject}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],33:[function(_dereq_,module,exports){"use strict";var createAuthorizationData=_dereq_("./create-authorization-data");var jsonClone=_dereq_("./json-clone");var constants=_dereq_("./constants");function addMetadata(configuration,data){var key;var attrs=data?jsonClone(data):{};var authAttrs=createAuthorizationData(configuration.authorization).attrs;var _meta=jsonClone(configuration.analyticsMetadata);attrs.braintreeLibraryVersion=constants.BRAINTREE_LIBRARY_VERSION;for(key in attrs._meta){if(attrs._meta.hasOwnProperty(key)){_meta[key]=attrs._meta[key]}}attrs._meta=_meta;if(authAttrs.tokenizationKey){attrs.tokenizationKey=authAttrs.tokenizationKey}else{attrs.authorizationFingerprint=authAttrs.authorizationFingerprint}return attrs}module.exports=addMetadata},{"./constants":38,"./create-authorization-data":41,"./json-clone":47}],34:[function(_dereq_,module,exports){"use strict";var Promise=_dereq_("./promise");var constants=_dereq_("./constants");var addMetadata=_dereq_("./add-metadata");function _millisToSeconds(millis){return Math.floor(millis/1e3)}function sendAnalyticsEvent(clientInstanceOrPromise,kind,callback){var timestamp=_millisToSeconds(Date.now());return Promise.resolve(clientInstanceOrPromise).then(function(client){var timestampInPromise=_millisToSeconds(Date.now());var configuration=client.getConfiguration();var request=client._request;var url=configuration.gatewayConfiguration.analytics.url;var data={analytics:[{kind:constants.ANALYTICS_PREFIX+kind,isAsync:timestampInPromise!==timestamp,timestamp:timestamp}]};request({url:url,method:"post",data:addMetadata(configuration,data),timeout:constants.ANALYTICS_REQUEST_TIMEOUT_MS},callback)})}module.exports={sendEvent:sendAnalyticsEvent}},{"./add-metadata":33,"./constants":38,"./promise":50}],35:[function(_dereq_,module,exports){"use strict";var loadScript=_dereq_("@braintree/asset-loader/load-script");module.exports={loadScript:loadScript}},{"@braintree/asset-loader/load-script":2}],36:[function(_dereq_,module,exports){"use strict";var assignNormalized=typeof Object.assign==="function"?Object.assign:assignPolyfill;function assignPolyfill(destination){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source){if(source.hasOwnProperty(key)){destination[key]=source[key]}}}return destination}module.exports={assign:assignNormalized,_assign:assignPolyfill}},{}],37:[function(_dereq_,module,exports){"use strict";var enumerate=_dereq_("./enumerate");function BraintreeError(options){if(!BraintreeError.types.hasOwnProperty(options.type)){throw new Error(options.type+" is not a valid type.")}if(!options.code){throw new Error("Error code required.")}if(!options.message){throw new Error("Error message required.")}this.name="BraintreeError";this.code=options.code;this.message=options.message;this.type=options.type;this.details=options.details}BraintreeError.prototype=Object.create(Error.prototype);BraintreeError.prototype.constructor=BraintreeError;BraintreeError.types=enumerate(["CUSTOMER","MERCHANT","NETWORK","INTERNAL","UNKNOWN"]);BraintreeError.findRootError=function(err){if(err instanceof BraintreeError&&err.details&&err.details.originalError){return BraintreeError.findRootError(err.details.originalError)}return err};module.exports=BraintreeError},{"./enumerate":43}],38:[function(_dereq_,module,exports){"use strict";var VERSION="3.45.0";var PLATFORM="web";var CLIENT_API_URLS={production:"https://api.braintreegateway.com:443",sandbox:"https://api.sandbox.braintreegateway.com:443"};var ASSETS_URLS={production:"https://assets.braintreegateway.com",sandbox:"https://assets.braintreegateway.com"};var GRAPHQL_URLS={production:"https://payments.braintree-api.com/graphql",sandbox:"https://payments.sandbox.braintree-api.com/graphql"};module.exports={ANALYTICS_PREFIX:PLATFORM+".",ANALYTICS_REQUEST_TIMEOUT_MS:2e3,ASSETS_URLS:ASSETS_URLS,CLIENT_API_URLS:CLIENT_API_URLS,FRAUDNET_SOURCE:"BRAINTREE_SIGNIN",FRAUDNET_FNCLS:"fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99",FRAUDNET_URL:"https://c.paypal.com/da/r/fb.js",GRAPHQL_URLS:GRAPHQL_URLS,INTEGRATION_TIMEOUT_MS:6e4,VERSION:VERSION,INTEGRATION:"custom",SOURCE:"client",PLATFORM:PLATFORM,BRAINTREE_LIBRARY_VERSION:"braintree/"+PLATFORM+"/"+VERSION}},{}],39:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("./braintree-error");var sharedErrors=_dereq_("./errors");module.exports=function(instance,methodNames){methodNames.forEach(function(methodName){instance[methodName]=function(){throw new BraintreeError({type:sharedErrors.METHOD_CALLED_AFTER_TEARDOWN.type,code:sharedErrors.METHOD_CALLED_AFTER_TEARDOWN.code,message:methodName+" cannot be called after teardown."})}})}},{"./braintree-error":37,"./errors":44}],40:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("./braintree-error");function convertToBraintreeError(originalErr,btErrorObject){if(originalErr instanceof BraintreeError){return originalErr}return new BraintreeError({type:btErrorObject.type,code:btErrorObject.code,message:btErrorObject.message,details:{originalError:originalErr}})}module.exports=convertToBraintreeError},{"./braintree-error":37}],41:[function(_dereq_,module,exports){"use strict";var atob=_dereq_("../lib/vendor/polyfill").atob;var CLIENT_API_URLS=_dereq_("../lib/constants").CLIENT_API_URLS;function _isTokenizationKey(str){return/^[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9_]+$/.test(str)}function _parseTokenizationKey(tokenizationKey){var tokens=tokenizationKey.split("_");var environment=tokens[0];var merchantId=tokens.slice(2).join("_");return{merchantId:merchantId,environment:environment}}function createAuthorizationData(authorization){var parsedClientToken,parsedTokenizationKey;var data={attrs:{},configUrl:""};if(_isTokenizationKey(authorization)){parsedTokenizationKey=_parseTokenizationKey(authorization);data.environment=parsedTokenizationKey.environment;data.attrs.tokenizationKey=authorization;data.configUrl=CLIENT_API_URLS[parsedTokenizationKey.environment]+"/merchants/"+parsedTokenizationKey.merchantId+"/client_api/v1/configuration"}else{parsedClientToken=JSON.parse(atob(authorization));data.environment=parsedClientToken.environment;data.attrs.authorizationFingerprint=parsedClientToken.authorizationFingerprint;data.configUrl=parsedClientToken.configUrl;data.graphQL=parsedClientToken.graphQL}return data}module.exports=createAuthorizationData},{"../lib/constants":38,"../lib/vendor/polyfill":52}],42:[function(_dereq_,module,exports){"use strict";module.exports=function(fn){return function(){var args=arguments;setTimeout(function(){fn.apply(null,args)},1)}}},{}],43:[function(_dereq_,module,exports){"use strict";function enumerate(values,prefix){prefix=prefix==null?"":prefix;return values.reduce(function(enumeration,value){enumeration[value]=prefix+value;return enumeration},{})}module.exports=enumerate},{}],44:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("./braintree-error");module.exports={INVALID_USE_OF_INTERNAL_FUNCTION:{type:BraintreeError.types.INTERNAL,code:"INVALID_USE_OF_INTERNAL_FUNCTION"},INSTANTIATION_OPTION_REQUIRED:{type:BraintreeError.types.MERCHANT,code:"INSTANTIATION_OPTION_REQUIRED"},INCOMPATIBLE_VERSIONS:{type:BraintreeError.types.MERCHANT,code:"INCOMPATIBLE_VERSIONS"},CLIENT_SCRIPT_FAILED_TO_LOAD:{type:BraintreeError.types.NETWORK,code:"CLIENT_SCRIPT_FAILED_TO_LOAD",message:"Braintree client script could not be loaded."},METHOD_CALLED_AFTER_TEARDOWN:{type:BraintreeError.types.MERCHANT,code:"METHOD_CALLED_AFTER_TEARDOWN"},BRAINTREE_API_ACCESS_RESTRICTED:{type:BraintreeError.types.MERCHANT,code:"BRAINTREE_API_ACCESS_RESTRICTED",message:"Your access is restricted and cannot use this part of the Braintree API."}}},{"./braintree-error":37}],45:[function(_dereq_,module,exports){"use strict";function convertDateStringToDate(dateString){var splitDate=dateString.split("-");return new Date(splitDate[0],splitDate[1],splitDate[2])}function isDateStringBeforeOrOn(firstDate,secondDate){return convertDateStringToDate(firstDate)<=convertDateStringToDate(secondDate)}module.exports=isDateStringBeforeOrOn},{}],46:[function(_dereq_,module,exports){"use strict";var parser;var legalHosts={"paypal.com":1,"braintreepayments.com":1,"braintreegateway.com":1,"braintree-api.com":1};function stripSubdomains(domain){return domain.split(".").slice(-2).join(".")}function isVerifiedDomain(url){var mainDomain;url=url.toLowerCase();if(!/^https:/.test(url)){return false}parser=parser||document.createElement("a");parser.href=url;mainDomain=stripSubdomains(parser.hostname);return legalHosts.hasOwnProperty(mainDomain)}module.exports=isVerifiedDomain},{}],47:[function(_dereq_,module,exports){"use strict";module.exports=function(value){return JSON.parse(JSON.stringify(value))}},{}],48:[function(_dereq_,module,exports){"use strict";module.exports=function(obj){return Object.keys(obj).filter(function(key){return typeof obj[key]==="function"})}},{}],49:[function(_dereq_,module,exports){arguments[4][7][0].apply(exports,arguments)},{dup:7}],50:[function(_dereq_,module,exports){(function(global){"use strict";var Promise=global.Promise||_dereq_("promise-polyfill");module.exports=Promise}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"promise-polyfill":10}],51:[function(_dereq_,module,exports){(function(global){"use strict";function _notEmpty(obj){var key;for(key in obj){if(obj.hasOwnProperty(key)){return true}}return false}function _isArray(value){return value&&typeof value==="object"&&typeof value.length==="number"&&Object.prototype.toString.call(value)==="[object Array]"||false}function parse(url){var query,params;url=url||global.location.href;if(!/\?/.test(url)){return{}}query=url.replace(/#.*$/,"").replace(/^.*\?/,"").split("&");params=query.reduce(function(toReturn,keyValue){var parts=keyValue.split("=");var key=decodeURIComponent(parts[0]);var value=decodeURIComponent(parts[1]);toReturn[key]=value;return toReturn},{});return params}function stringify(params,namespace){var k,v,p;var query=[];for(p in params){if(!params.hasOwnProperty(p)){continue}v=params[p];if(namespace){if(_isArray(params)){k=namespace+"[]"}else{k=namespace+"["+p+"]"}}else{k=p}if(typeof v==="object"){query.push(stringify(v,k))}else{query.push(encodeURIComponent(k)+"="+encodeURIComponent(v))}}return query.join("&")}function queryify(url,params){url=url||"";if(params!=null&&typeof params==="object"&&_notEmpty(params)){url+=url.indexOf("?")===-1?"?":"";url+=url.indexOf("=")!==-1?"&":"";url+=stringify(params)}return url}module.exports={parse:parse,stringify:stringify,queryify:queryify}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],52:[function(_dereq_,module,exports){(function(global){"use strict";var atobNormalized=typeof global.atob==="function"?global.atob:atob;function atob(base64String){var a,b,c,b1,b2,b3,b4,i;var base64Matcher=new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})([=]{1,2})?$");var characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var result="";if(!base64Matcher.test(base64String)){throw new Error("Non base64 encoded input passed to window.atob polyfill")}i=0;do{b1=characters.indexOf(base64String.charAt(i++));b2=characters.indexOf(base64String.charAt(i++));b3=characters.indexOf(base64String.charAt(i++));b4=characters.indexOf(base64String.charAt(i++));a=(b1&63)<<2|b2>>4&3;b=(b2&15)<<4|b3>>2&15;c=(b3&3)<<6|b4&63;result+=String.fromCharCode(a)+(b?String.fromCharCode(b):"")+(c?String.fromCharCode(c):"")}while(i<base64String.length);return result}module.exports={atob:function(base64String){return atobNormalized.call(global,base64String)},_atob:atob}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],53:[function(_dereq_,module,exports){"use strict";function uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0;var v=c==="x"?r:r&3|8;return v.toString(16)})}module.exports=uuid},{}]},{},[16])(16)});(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}(g.braintree||(g.braintree={})).hostedFields=f()}})(function(){var define,module,exports;return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(_dereq_,module,exports){(function(global){"use strict";var PromisePolyfill=_dereq_("promise-polyfill");module.exports=global.Promise||PromisePolyfill}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"promise-polyfill":29}],2:[function(_dereq_,module,exports){"use strict";var Promise=_dereq_("./lib/promise");var scriptPromiseCache={};function loadScript(options){var attrs,container,script,scriptLoadPromise;var stringifiedOptions=JSON.stringify(options);if(!options.forceScriptReload){scriptLoadPromise=scriptPromiseCache[stringifiedOptions];if(scriptLoadPromise){return scriptLoadPromise}}script=document.createElement("script");attrs=options.dataAttributes||{};container=options.container||document.head;script.src=options.src;script.id=options.id;script.async=true;Object.keys(attrs).forEach(function(key){script.setAttribute("data-"+key,attrs[key])});scriptLoadPromise=new Promise(function(resolve,reject){script.addEventListener("load",function(){resolve(script)});script.addEventListener("error",function(){reject(new Error(options.src+" failed to load."))});script.addEventListener("abort",function(){reject(new Error(options.src+" has aborted."))});container.appendChild(script)});scriptPromiseCache[stringifiedOptions]=scriptLoadPromise;return scriptLoadPromise}loadScript.clearCache=function(){scriptPromiseCache={}};module.exports=loadScript},{"./lib/promise":1}],3:[function(_dereq_,module,exports){(function(global){"use strict";module.exports=function isAndroid(ua){ua=ua||global.navigator.userAgent;return/Android/.test(ua)}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],4:[function(_dereq_,module,exports){"use strict";var isEdge=_dereq_("./is-edge");var isSamsung=_dereq_("./is-samsung");module.exports=function isChrome(ua){ua=ua||navigator.userAgent;return(ua.indexOf("Chrome")!==-1||ua.indexOf("CriOS")!==-1)&&!isEdge(ua)&&!isSamsung(ua)}},{"./is-edge":5,"./is-samsung":11}],5:[function(_dereq_,module,exports){"use strict";module.exports=function isEdge(ua){ua=ua||navigator.userAgent;return ua.indexOf("Edge/")!==-1}},{}],6:[function(_dereq_,module,exports){(function(global){"use strict";var isIE11=_dereq_("./is-ie11");module.exports=function isIE(ua){ua=ua||global.navigator.userAgent;return ua.indexOf("MSIE")!==-1||isIE11(ua)}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./is-ie11":7}],7:[function(_dereq_,module,exports){"use strict";module.exports=function isIe11(ua){ua=ua||navigator.userAgent;return ua.indexOf("Trident/7")!==-1}},{}],8:[function(_dereq_,module,exports){"use strict";module.exports=function isIe9(ua){ua=ua||navigator.userAgent;return ua.indexOf("MSIE 9")!==-1}},{}],9:[function(_dereq_,module,exports){(function(global){"use strict";var isIos=_dereq_("./is-ios");function isGoogleSearchApp(ua){return/\bGSA\b/.test(ua)}module.exports=function isIosWebview(ua){ua=ua||global.navigator.userAgent;if(isIos(ua)){if(isGoogleSearchApp(ua)){return true}return/.+AppleWebKit(?!.*Safari)/.test(ua)}return false}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./is-ios":10}],10:[function(_dereq_,module,exports){(function(global){"use strict";module.exports=function isIos(ua){ua=ua||global.navigator.userAgent;return/iPhone|iPod|iPad/i.test(ua)}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],11:[function(_dereq_,module,exports){(function(global){"use strict";module.exports=function isSamsungBrowser(ua){ua=ua||global.navigator.userAgent;return/SamsungBrowser/i.test(ua)}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],12:[function(_dereq_,module,exports){"use strict";function _classesOf(element){return element.className.trim().split(/\s+/)}function add(element){var toAdd=Array.prototype.slice.call(arguments,1);var className=_classesOf(element).filter(function(classname){return toAdd.indexOf(classname)===-1}).concat(toAdd).join(" ");element.className=className}function remove(element){var toRemove=Array.prototype.slice.call(arguments,1);var className=_classesOf(element).filter(function(classname){return toRemove.indexOf(classname)===-1}).join(" ");element.className=className}function toggle(element,classname,adding){if(adding){add(element,classname)}else{remove(element,classname)}}module.exports={add:add,remove:remove,toggle:toggle}},{}],13:[function(_dereq_,module,exports){"use strict";var setAttributes=_dereq_("./lib/set-attributes");var defaultAttributes=_dereq_("./lib/default-attributes");var assign=_dereq_("./lib/assign");module.exports=function createFrame(options){var iframe=document.createElement("iframe");var config=assign({},defaultAttributes,options);if(config.style&&typeof config.style!=="string"){assign(iframe.style,config.style);delete config.style}setAttributes(iframe,config);if(!iframe.getAttribute("id")){iframe.id=iframe.name}return iframe}},{"./lib/assign":14,"./lib/default-attributes":15,"./lib/set-attributes":16}],14:[function(_dereq_,module,exports){"use strict";module.exports=function assign(target){var objs=Array.prototype.slice.call(arguments,1);objs.forEach(function(obj){if(typeof obj!=="object"){return}Object.keys(obj).forEach(function(key){target[key]=obj[key]})});return target}},{}],15:[function(_dereq_,module,exports){"use strict";module.exports={src:"about:blank",frameBorder:0,allowtransparency:true,scrolling:"no"}},{}],16:[function(_dereq_,module,exports){"use strict";module.exports=function setAttributes(element,attributes){var value;for(var key in attributes){if(attributes.hasOwnProperty(key)){value=attributes[key];if(value==null){element.removeAttribute(key)}else{element.setAttribute(key,value)}}}}},{}],17:[function(_dereq_,module,exports){"use strict";function deferred(fn){return function(){var args=arguments;setTimeout(function(){try{fn.apply(null,args)}catch(err){console.log("Error in callback function");console.log(err)}},1)}}module.exports=deferred},{}],18:[function(_dereq_,module,exports){"use strict";function once(fn){var called=false;return function(){if(!called){called=true;fn.apply(null,arguments)}}}module.exports=once},{}],19:[function(_dereq_,module,exports){"use strict";function promiseOrCallback(promise,callback){if(callback){promise.then(function(data){callback(null,data)}).catch(function(err){callback(err)})}else{return promise}}module.exports=promiseOrCallback},{}],20:[function(_dereq_,module,exports){"use strict";var deferred=_dereq_("./lib/deferred");var once=_dereq_("./lib/once");var promiseOrCallback=_dereq_("./lib/promise-or-callback");function wrapPromise(fn){return function(){var callback;var args=Array.prototype.slice.call(arguments);var lastArg=args[args.length-1];if(typeof lastArg==="function"){callback=args.pop();callback=once(deferred(callback))}return promiseOrCallback(fn.apply(this,args),callback)}}wrapPromise.wrapPrototype=function(target,options){var methods,ignoreMethods,includePrivateMethods;options=options||{};ignoreMethods=options.ignoreMethods||[];includePrivateMethods=options.transformPrivateMethods===true;methods=Object.getOwnPropertyNames(target.prototype).filter(function(method){var isNotPrivateMethod;var isNonConstructorFunction=method!=="constructor"&&typeof target.prototype[method]==="function";var isNotAnIgnoredMethod=ignoreMethods.indexOf(method)===-1;if(includePrivateMethods){isNotPrivateMethod=true}else{isNotPrivateMethod=method.charAt(0)!=="_"}return isNonConstructorFunction&&isNotPrivateMethod&&isNotAnIgnoredMethod});methods.forEach(function(method){var original=target.prototype[method];target.prototype[method]=wrapPromise(original)});return target};module.exports=wrapPromise},{"./lib/deferred":17,"./lib/once":18,"./lib/promise-or-callback":19}],21:[function(_dereq_,module,exports){"use strict";var types=_dereq_("./lib/card-types");var clone=_dereq_("./lib/clone");var findBestMatch=_dereq_("./lib/find-best-match");var isValidInputType=_dereq_("./lib/is-valid-input-type");var addMatchingCardsToResults=_dereq_("./lib/add-matching-cards-to-results");var testOrder;var customCards={};var cardNames={VISA:"visa",MASTERCARD:"mastercard",AMERICAN_EXPRESS:"american-express",DINERS_CLUB:"diners-club",DISCOVER:"discover",JCB:"jcb",UNIONPAY:"unionpay",MAESTRO:"maestro",ELO:"elo",MIR:"mir",HIPER:"hiper",HIPERCARD:"hipercard"};var ORIGINAL_TEST_ORDER=[cardNames.VISA,cardNames.MASTERCARD,cardNames.AMERICAN_EXPRESS,cardNames.DINERS_CLUB,cardNames.DISCOVER,cardNames.JCB,cardNames.UNIONPAY,cardNames.MAESTRO,cardNames.ELO,cardNames.MIR,cardNames.HIPER,cardNames.HIPERCARD];testOrder=clone(ORIGINAL_TEST_ORDER);function findType(type){return customCards[type]||types[type]}function getAllCardTypes(){return testOrder.map(function(type){return clone(findType(type))})}function getCardPosition(name,ignoreErrorForNotExisting){var position=testOrder.indexOf(name);if(!ignoreErrorForNotExisting&&position===-1){throw new Error('"'+name+'" is not a supported card type.')}return position}function creditCardType(cardNumber){var bestMatch;var results=[];if(!isValidInputType(cardNumber)){return[]}if(cardNumber.length===0){return getAllCardTypes(testOrder)}testOrder.forEach(function(type){var cardConfiguration=findType(type);addMatchingCardsToResults(cardNumber,cardConfiguration,results)});bestMatch=findBestMatch(results);if(bestMatch){return[bestMatch]}return results}creditCardType.getTypeInfo=function(type){return clone(findType(type))};creditCardType.removeCard=function(name){var position=getCardPosition(name);testOrder.splice(position,1)};creditCardType.addCard=function(config){var existingCardPosition=getCardPosition(config.type,true);customCards[config.type]=config;if(existingCardPosition===-1){testOrder.push(config.type)}};creditCardType.updateCard=function(cardType,updates){var clonedCard;var originalObject=customCards[cardType]||types[cardType];if(!originalObject){throw new Error('"'+cardType+'" is not a recognized type. Use `addCard` instead.')}if(updates.type&&originalObject.type!==updates.type){throw new Error("Cannot overwrite type parameter.")}clonedCard=clone(originalObject,true);Object.keys(clonedCard).forEach(function(key){if(updates[key]){clonedCard[key]=updates[key]}});customCards[clonedCard.type]=clonedCard};creditCardType.changeOrder=function(name,position){var currentPosition=getCardPosition(name);testOrder.splice(currentPosition,1);testOrder.splice(position,0,name)};creditCardType.resetModifications=function(){testOrder=clone(ORIGINAL_TEST_ORDER);customCards={}};creditCardType.types=cardNames;module.exports=creditCardType},{"./lib/add-matching-cards-to-results":22,"./lib/card-types":23,"./lib/clone":24,"./lib/find-best-match":25,"./lib/is-valid-input-type":26}],22:[function(_dereq_,module,exports){"use strict";var clone=_dereq_("./clone");var matches=_dereq_("./matches");function addMatchingCardsToResults(cardNumber,cardConfiguration,results){var i,pattern,patternLength,clonedCardConfiguration;for(i=0;i<cardConfiguration.patterns.length;i++){pattern=cardConfiguration.patterns[i];if(!matches(cardNumber,pattern)){continue}clonedCardConfiguration=clone(cardConfiguration);if(Array.isArray(pattern)){patternLength=String(pattern[0]).length}else{patternLength=String(pattern).length}if(cardNumber.length>=patternLength){clonedCardConfiguration.matchStrength=patternLength}results.push(clonedCardConfiguration);break}}module.exports=addMatchingCardsToResults},{"./clone":24,"./matches":27}],23:[function(_dereq_,module,exports){"use strict";var cardTypes={visa:{niceType:"Visa",type:"visa",patterns:[4],gaps:[4,8,12],lengths:[16,18,19],code:{name:"CVV",size:3}},mastercard:{niceType:"Mastercard",type:"mastercard",patterns:[[51,55],[2221,2229],[223,229],[23,26],[270,271],2720],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}},"american-express":{niceType:"American Express",type:"american-express",patterns:[34,37],gaps:[4,10],lengths:[15],code:{name:"CID",size:4}},"diners-club":{niceType:"Diners Club",type:"diners-club",patterns:[[300,305],36,38,39],gaps:[4,10],lengths:[14,16,19],code:{name:"CVV",size:3}},discover:{niceType:"Discover",type:"discover",patterns:[6011,[644,649],65],gaps:[4,8,12],lengths:[16,19],code:{name:"CID",size:3}},jcb:{niceType:"JCB",type:"jcb",patterns:[2131,1800,[3528,3589]],gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVV",size:3}},unionpay:{niceType:"UnionPay",type:"unionpay",patterns:[620,[624,626],[62100,62182],[62184,62187],[62185,62197],[62200,62205],[622010,622999],622018,[622019,622999],[62207,62209],[622126,622925],[623,626],6270,6272,6276,[627700,627779],[627781,627799],[6282,6289],6291,6292],gaps:[4,8,12],lengths:[14,15,16,17,18,19],code:{name:"CVN",size:3}},maestro:{niceType:"Maestro",type:"maestro",patterns:[493698,[5e5,506698],[506779,508999],[56,59],63,67,6],gaps:[4,8,12],lengths:[12,13,14,15,16,17,18,19],code:{name:"CVC",size:3}},elo:{niceType:"Elo",type:"elo",patterns:[401178,401179,438935,457631,457632,431274,451416,457393,504175,[506699,506778],[509e3,509999],627780,636297,636368,[650031,650033],[650035,650051],[650405,650439],[650485,650538],[650541,650598],[650700,650718],[650720,650727],[650901,650978],[651652,651679],[655e3,655019],[655021,655058]],gaps:[4,8,12],lengths:[16],code:{name:"CVE",size:3}},mir:{niceType:"Mir",type:"mir",patterns:[[2200,2204]],gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVP2",size:3}},hiper:{niceType:"Hiper",type:"hiper",patterns:[637095,637568,637599,637609,637612],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}},hipercard:{niceType:"Hipercard",type:"hipercard",patterns:[606282],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}}};module.exports=cardTypes},{}],24:[function(_dereq_,module,exports){"use strict";function clone(originalObject){var dupe;if(!originalObject){return null}dupe=JSON.parse(JSON.stringify(originalObject));return dupe}module.exports=clone},{}],25:[function(_dereq_,module,exports){"use strict";function hasEnoughResultsToDetermineBestMatch(results){var numberOfResultsWithMaxStrengthProperty=results.filter(function(result){return result.matchStrength}).length;return numberOfResultsWithMaxStrengthProperty>0&&numberOfResultsWithMaxStrengthProperty===results.length}function findBestMatch(results){if(!hasEnoughResultsToDetermineBestMatch(results)){return}return results.reduce(function(bestMatch,result){if(!bestMatch){return result}if(bestMatch.matchStrength<result.matchStrength){return result}return bestMatch})}module.exports=findBestMatch},{}],26:[function(_dereq_,module,exports){"use strict";function isValidInputType(cardNumber){return typeof cardNumber==="string"||cardNumber instanceof String}module.exports=isValidInputType},{}],27:[function(_dereq_,module,exports){"use strict";function matchesRange(cardNumber,min,max){var maxLengthToCheck=String(min).length;var substr=cardNumber.substr(0,maxLengthToCheck);var integerRepresentationOfCardNumber=parseInt(substr,10);min=parseInt(String(min).substr(0,substr.length),10);max=parseInt(String(max).substr(0,substr.length),10);return integerRepresentationOfCardNumber>=min&&integerRepresentationOfCardNumber<=max}function matchesPattern(cardNumber,pattern){pattern=String(pattern);return pattern.substring(0,cardNumber.length)===cardNumber.substring(0,pattern.length)}function matches(cardNumber,pattern){if(Array.isArray(pattern)){return matchesRange(cardNumber,pattern[0],pattern[1])}return matchesPattern(cardNumber,pattern)}module.exports=matches},{}],28:[function(_dereq_,module,exports){(function(global){"use strict";var win,framebus;var popups=[];var subscribers={};var prefix="/*framebus*/";function include(popup){if(popup==null){return false}if(popup.Window==null){return false}if(popup.constructor!==popup.Window){return false}popups.push(popup);return true}function target(origin){var key;var targetedFramebus={};for(key in framebus){if(!framebus.hasOwnProperty(key)){continue}targetedFramebus[key]=framebus[key]}targetedFramebus._origin=origin||"*";return targetedFramebus}function publish(event){var payload,args;var origin=_getOrigin(this);if(_isntString(event)){return false}if(_isntString(origin)){return false}args=Array.prototype.slice.call(arguments,1);payload=_packagePayload(event,args,origin);if(payload===false){return false}_broadcast(win.top||win.self,payload,origin);return true}function subscribe(event,fn){var origin=_getOrigin(this);if(_subscriptionArgsInvalid(event,fn,origin)){return false}subscribers[origin]=subscribers[origin]||{};subscribers[origin][event]=subscribers[origin][event]||[];subscribers[origin][event].push(fn);return true}function unsubscribe(event,fn){var i,subscriberList;var origin=_getOrigin(this);if(_subscriptionArgsInvalid(event,fn,origin)){return false}subscriberList=subscribers[origin]&&subscribers[origin][event];if(!subscriberList){return false}for(i=0;i<subscriberList.length;i++){if(subscriberList[i]===fn){subscriberList.splice(i,1);return true}}return false}function _getOrigin(scope){return scope&&scope._origin||"*"}function _isntString(string){return typeof string!=="string"}function _packagePayload(event,args,origin){var packaged=false;var payload={event:event,origin:origin};var reply=args[args.length-1];if(typeof reply==="function"){payload.reply=_subscribeReplier(reply,origin);args=args.slice(0,-1)}payload.args=args;try{packaged=prefix+JSON.stringify(payload)}catch(e){throw new Error("Could not stringify event: "+e.message)}return packaged}function _unpackPayload(e){var payload,replyOrigin,replySource,replyEvent;if(e.data.slice(0,prefix.length)!==prefix){return false}try{payload=JSON.parse(e.data.slice(prefix.length))}catch(err){return false}if(payload.reply!=null){replyOrigin=e.origin;replySource=e.source;replyEvent=payload.reply;payload.reply=function reply(data){var replyPayload;if(!replySource){return false}replyPayload=_packagePayload(replyEvent,[data],replyOrigin);if(replyPayload===false){return false}replySource.postMessage(replyPayload,replyOrigin)};payload.args.push(payload.reply)}return payload}function _attach(w){if(win){return}win=w||global;if(win.addEventListener){win.addEventListener("message",_onmessage,false)}else if(win.attachEvent){win.attachEvent("onmessage",_onmessage)}else if(win.onmessage===null){win.onmessage=_onmessage}else{win=null}}function _detach(){if(win==null){return}if(win.removeEventListener){win.removeEventListener("message",_onmessage,false)}else if(win.detachEvent){win.detachEvent("onmessage",_onmessage)}else if(win.onmessage===_onmessage){win.onmessage=null}win=null;popups=[];subscribers={}}function _uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0;var v=c==="x"?r:r&3|8;return v.toString(16)})}function _onmessage(e){var payload;if(_isntString(e.data)){return}payload=_unpackPayload(e);if(!payload){return}_dispatch("*",payload.event,payload.args,e);_dispatch(e.origin,payload.event,payload.args,e);_broadcastPopups(e.data,payload.origin,e.source)}function _dispatch(origin,event,args,e){var i;if(!subscribers[origin]){return}if(!subscribers[origin][event]){return}for(i=0;i<subscribers[origin][event].length;i++){subscribers[origin][event][i].apply(e,args)}}function _hasOpener(frame){if(frame.top!==frame){return false}if(frame.opener==null){return false}if(frame.opener===frame){return false}if(frame.opener.closed===true){return false}return true}function _broadcast(frame,payload,origin){var i=0;var frameToBroadcastTo;try{frame.postMessage(payload,origin);if(_hasOpener(frame)){_broadcast(frame.opener.top,payload,origin)}while(frameToBroadcastTo=frame.frames[i]){_broadcast(frameToBroadcastTo,payload,origin);i++}}catch(_){}}function _broadcastPopups(payload,origin,source){var i,popup;for(i=popups.length-1;i>=0;i--){popup=popups[i];if(popup.closed===true){popups=popups.slice(i,1)}else if(source!==popup){_broadcast(popup.top,payload,origin)}}}function _subscribeReplier(fn,origin){var uuid=_uuid();function replier(d,o){fn(d,o);framebus.target(origin).unsubscribe(uuid,replier)}framebus.target(origin).subscribe(uuid,replier);return uuid}function _subscriptionArgsInvalid(event,fn,origin){if(_isntString(event)){return true}if(typeof fn!=="function"){return true}if(_isntString(origin)){return true}return false}_attach();framebus={target:target,_packagePayload:_packagePayload,_unpackPayload:_unpackPayload,_attach:_attach,_detach:_detach,_dispatch:_dispatch,_broadcast:_broadcast,_subscribeReplier:_subscribeReplier,_subscriptionArgsInvalid:_subscriptionArgsInvalid,_onmessage:_onmessage,_uuid:_uuid,_getSubscribers:function(){return subscribers},_win:function(){return win},include:include,publish:publish,pub:publish,trigger:publish,emit:publish,subscribe:subscribe,sub:subscribe,on:subscribe,unsubscribe:unsubscribe,unsub:unsubscribe,off:unsubscribe};module.exports=framebus}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],29:[function(_dereq_,module,exports){"use strict";function finallyConstructor(callback){var constructor=this.constructor;return this.then(function(value){return constructor.resolve(callback()).then(function(){return value})},function(reason){return constructor.resolve(callback()).then(function(){return constructor.reject(reason)})})}var setTimeoutFunc=setTimeout;function noop(){}function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function Promise(fn){if(!(this instanceof Promise))throw new TypeError("Promises must be constructed via new");if(typeof fn!=="function")throw new TypeError("not a function");this._state=0;this._handled=false;this._value=undefined;this._deferreds=[];doResolve(fn,this)}function handle(self,deferred){while(self._state===3){self=self._value}if(self._state===0){self._deferreds.push(deferred);return}self._handled=true;Promise._immediateFn(function(){var cb=self._state===1?deferred.onFulfilled:deferred.onRejected;if(cb===null){(self._state===1?resolve:reject)(deferred.promise,self._value);return}var ret;try{ret=cb(self._value)}catch(e){reject(deferred.promise,e);return}resolve(deferred.promise,ret)})}function resolve(self,newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&(typeof newValue==="object"||typeof newValue==="function")){var then=newValue.then;if(newValue instanceof Promise){self._state=3;self._value=newValue;finale(self);return}else if(typeof then==="function"){doResolve(bind(then,newValue),self);return}}self._state=1;self._value=newValue;finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2;self._value=newValue;finale(self)}function finale(self){if(self._state===2&&self._deferreds.length===0){Promise._immediateFn(function(){if(!self._handled){Promise._unhandledRejectionFn(self._value)}})}for(var i=0,len=self._deferreds.length;i<len;i++){handle(self,self._deferreds[i])}self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled=typeof onFulfilled==="function"?onFulfilled:null;this.onRejected=typeof onRejected==="function"?onRejected:null;this.promise=promise}function doResolve(fn,self){var done=false;try{fn(function(value){if(done)return;done=true;resolve(self,value)},function(reason){if(done)return;done=true;reject(self,reason)})}catch(ex){if(done)return;done=true;reject(self,ex)}}Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected)};Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);handle(this,new Handler(onFulfilled,onRejected,prom));return prom};Promise.prototype["finally"]=finallyConstructor;Promise.all=function(arr){return new Promise(function(resolve,reject){if(!arr||typeof arr.length==="undefined")throw new TypeError("Promise.all accepts an array");var args=Array.prototype.slice.call(arr);if(args.length===0)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&(typeof val==="object"||typeof val==="function")){var then=val.then;if(typeof then==="function"){then.call(val,function(val){res(i,val)},reject);return}}args[i]=val;if(--remaining===0){resolve(args)}}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++){res(i,args[i])}})};Promise.resolve=function(value){if(value&&typeof value==="object"&&value.constructor===Promise){return value}return new Promise(function(resolve){resolve(value)})};Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})};Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++){values[i].then(resolve,reject)}})};Promise._immediateFn=typeof setImmediate==="function"&&function(fn){setImmediate(fn)}||function(fn){setTimeoutFunc(fn,0)};Promise._unhandledRejectionFn=function _unhandledRejectionFn(err){if(typeof console!=="undefined"&&console){console.warn("Possible Unhandled Promise Rejection:",err)}};module.exports=Promise},{}],30:[function(_dereq_,module,exports){(function(global){"use strict";var UA=global.navigator&&global.navigator.userAgent;var isAndroid=_dereq_("@braintree/browser-detection/is-android");var isChrome=_dereq_("@braintree/browser-detection/is-chrome");var isIos=_dereq_("@braintree/browser-detection/is-ios");var isIE9=_dereq_("@braintree/browser-detection/is-ie9");var KITKAT_WEBVIEW_REGEX=/Version\/\d\.\d* Chrome\/\d*\.0\.0\.0/;function _isOldSamsungBrowserOrSamsungWebview(ua){return!isChrome(ua)&&ua.indexOf("Samsung")>-1}function isKitKatWebview(uaArg){var ua=uaArg||UA;return isAndroid(ua)&&KITKAT_WEBVIEW_REGEX.test(ua)}function isAndroidChrome(uaArg){var ua=uaArg||UA;return isAndroid(ua)&&isChrome(ua)}function isSamsungBrowser(ua){ua=ua||UA;return/SamsungBrowser/.test(ua)||_isOldSamsungBrowserOrSamsungWebview(ua)}module.exports={isIE9:isIE9,isAndroidChrome:isAndroidChrome,isIos:isIos,isKitKatWebview:isKitKatWebview,isSamsungBrowser:isSamsungBrowser}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"@braintree/browser-detection/is-android":3,"@braintree/browser-detection/is-chrome":4,"@braintree/browser-detection/is-ie9":8,"@braintree/browser-detection/is-ios":10}],31:[function(_dereq_,module,exports){"use strict";var device=_dereq_("./lib/device");module.exports=function(){return!device.isSamsungBrowser()}},{"./lib/device":30}],32:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("../../lib/braintree-error");var errors=_dereq_("../shared/errors");var allowedAttributes=_dereq_("../shared/constants").allowedAttributes;function attributeValidationError(attribute,value){var err;if(!allowedAttributes.hasOwnProperty(attribute)){err=new BraintreeError({type:errors.HOSTED_FIELDS_ATTRIBUTE_NOT_SUPPORTED.type,code:errors.HOSTED_FIELDS_ATTRIBUTE_NOT_SUPPORTED.code,message:'The "'+attribute+'" attribute is not supported in Hosted Fields.'})}else if(value!=null&&!_isValid(attribute,value)){err=new BraintreeError({type:errors.HOSTED_FIELDS_ATTRIBUTE_VALUE_NOT_ALLOWED.type,code:errors.HOSTED_FIELDS_ATTRIBUTE_VALUE_NOT_ALLOWED.code,message:'Value "'+value+'" is not allowed for "'+attribute+'" attribute.'})}return err}function _isValid(attribute,value){if(allowedAttributes[attribute]==="string"){return typeof value==="string"||typeof value==="number"}else if(allowedAttributes[attribute]==="boolean"){return String(value)==="true"||String(value)==="false"}return false}module.exports=attributeValidationError},{"../../lib/braintree-error":49,"../shared/constants":39,"../shared/errors":40}],33:[function(_dereq_,module,exports){"use strict";var constants=_dereq_("../shared/constants");var useMin=_dereq_("../../lib/use-min");module.exports=function composeUrl(assetsUrl,componentId,isDebug){return assetsUrl+"/web/"+constants.VERSION+"/html/hosted-fields-frame"+useMin(isDebug)+".html#"+componentId}},{"../../lib/use-min":67,"../shared/constants":39}],34:[function(_dereq_,module,exports){(function(global){"use strict";var allowedStyles=_dereq_("../shared/constants").allowedStyles;module.exports=function getStylesFromClass(cssClass){var element=document.createElement("input");var styles={};var computedStyles;if(cssClass[0]==="."){cssClass=cssClass.substring(1)}element.className=cssClass;element.style.display="none !important";element.style.position="fixed !important";element.style.left="-99999px !important";element.style.top="-99999px !important";global.document.body.appendChild(element);computedStyles=global.getComputedStyle(element);allowedStyles.forEach(function(style){var value=computedStyles[style];if(value){styles[style]=value}});global.document.body.removeChild(element);return styles}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../shared/constants":39}],35:[function(_dereq_,module,exports){(function(global){"use strict";var assign=_dereq_("../../lib/assign").assign;var createAssetsUrl=_dereq_("../../lib/create-assets-url");var Destructor=_dereq_("../../lib/destructor");var classList=_dereq_("@braintree/class-list");var iFramer=_dereq_("@braintree/iframer");var Bus=_dereq_("../../lib/bus");var createDeferredClient=_dereq_("../../lib/create-deferred-client");var BraintreeError=_dereq_("../../lib/braintree-error");var composeUrl=_dereq_("./compose-url");var getStylesFromClass=_dereq_("./get-styles-from-class");var constants=_dereq_("../shared/constants");var errors=_dereq_("../shared/errors");var INTEGRATION_TIMEOUT_MS=_dereq_("../../lib/constants").INTEGRATION_TIMEOUT_MS;var uuid=_dereq_("../../lib/vendor/uuid");var findParentTags=_dereq_("../shared/find-parent-tags");var browserDetection=_dereq_("../shared/browser-detection");var events=constants.events;var EventEmitter=_dereq_("../../lib/event-emitter");var injectFrame=_dereq_("./inject-frame");var analytics=_dereq_("../../lib/analytics");var allowedFields=constants.allowedFields;var methods=_dereq_("../../lib/methods");var convertMethodsToError=_dereq_("../../lib/convert-methods-to-error");var sharedErrors=_dereq_("../../lib/errors");var getCardTypes=_dereq_("../shared/get-card-types");var attributeValidationError=_dereq_("./attribute-validation-error");var Promise=_dereq_("../../lib/promise");var wrapPromise=_dereq_("@braintree/wrap-promise");function createInputEventHandler(fields){return function(eventData){var field;var merchantPayload=eventData.merchantPayload;var emittedBy=merchantPayload.emittedBy;var container=fields[emittedBy].containerElement;Object.keys(merchantPayload.fields).forEach(function(key){merchantPayload.fields[key].container=fields[key].containerElement});field=merchantPayload.fields[emittedBy];if(eventData.type==="blur"){performBlurFixForIos(container)}classList.toggle(container,constants.externalClasses.FOCUSED,field.isFocused);classList.toggle(container,constants.externalClasses.VALID,field.isValid);classList.toggle(container,constants.externalClasses.INVALID,!field.isPotentiallyValid);this._state={cards:merchantPayload.cards,fields:merchantPayload.fields};this._emit(eventData.type,merchantPayload)}}function performBlurFixForIos(container){var hiddenInput;if(!browserDetection.isIos()){return}if(document.activeElement===document.body){hiddenInput=container.querySelector("input");if(!hiddenInput){hiddenInput=document.createElement("input");hiddenInput.type="button";hiddenInput.style.height="0px";hiddenInput.style.width="0px";hiddenInput.style.opacity="0";hiddenInput.style.padding="0";hiddenInput.style.position="absolute";hiddenInput.style.left="-200%";hiddenInput.style.top="0px";container.insertBefore(hiddenInput,container.firstChild)}hiddenInput.focus();hiddenInput.blur()}}function isVisibleEnough(node){var boundingBox=node.getBoundingClientRect();var verticalMidpoint=Math.floor(boundingBox.height/2);var horizontalMidpoint=Math.floor(boundingBox.width/2);return boundingBox.top<(global.innerHeight-verticalMidpoint||document.documentElement.clientHeight-verticalMidpoint)&&boundingBox.right>horizontalMidpoint&&boundingBox.bottom>verticalMidpoint&&boundingBox.left<(global.innerWidth-horizontalMidpoint||document.documentElement.clientWidth-horizontalMidpoint)}function fieldsDOMOrder(configFields){var fieldPosition=[];var fields=configFields;var sortedFieldNames=[];var validFieldsInUse=Object.keys(fields).filter(function(key){return allowedFields.hasOwnProperty(key)});validFieldsInUse.forEach(function(key){fieldPosition.push([key,fields[key].container])});fieldPosition.sort(function(a,b){var element1=a[1];var element2=b[1];var position=element1.compareDocumentPosition(element2);if(element1===element2){return 0}if(position&Node.DOCUMENT_POSITION_FOLLOWING||position&Node.DOCUMENT_POSITION_CONTAINED_BY){return-1}else if(position&Node.DOCUMENT_POSITION_PRECEDING||position&Node.DOCUMENT_POSITION_CONTAINS){return 1}return 0});fieldPosition.forEach(function(value){sortedFieldNames.push(value[0])});return sortedFieldNames}function HostedFields(options){var failureTimeout,clientConfig,assetsUrl,isDebug,hostedFieldsUrl;var self=this;var fields={};var busOptions=assign({},options);var frameReadyPromiseResolveFunctions={};var frameReadyPromises=[];var componentId=uuid();if(options.client){clientConfig=options.client.getConfiguration();assetsUrl=clientConfig.gatewayConfiguration.assetsUrl;isDebug=clientConfig.isDebug}else{assetsUrl=createAssetsUrl.create(options.authorization);isDebug=Boolean(options.isDebug)}this._clientPromise=createDeferredClient.create({client:options.client,authorization:options.authorization,debug:isDebug,assetsUrl:assetsUrl,name:"Hosted Fields"});hostedFieldsUrl=composeUrl(assetsUrl,componentId,isDebug);if(!options.fields||Object.keys(options.fields).length===0){throw new BraintreeError({type:sharedErrors.INSTANTIATION_OPTION_REQUIRED.type,code:sharedErrors.INSTANTIATION_OPTION_REQUIRED.code,message:"options.fields is required when instantiating Hosted Fields."})}EventEmitter.call(this);this._injectedNodes=[];this._destructor=new Destructor;this._fields=fields;this._state={fields:{},cards:getCardTypes("")};this._bus=new Bus({channel:componentId,merchantUrl:location.href});this._destructor.registerFunctionForTeardown(function(){self._bus.teardown()});analytics.sendEvent(this._clientPromise,"custom.hosted-fields.initialized");Object.keys(options.fields).forEach(function(key){var field,container,frame,frameReadyPromise;if(!constants.allowedFields.hasOwnProperty(key)){throw new BraintreeError({type:errors.HOSTED_FIELDS_INVALID_FIELD_KEY.type,code:errors.HOSTED_FIELDS_INVALID_FIELD_KEY.code,message:'"'+key+'" is not a valid field.'})}field=options.fields[key];container=document.querySelector(field.selector);if(!container){throw new BraintreeError({type:errors.HOSTED_FIELDS_INVALID_FIELD_SELECTOR.type,code:errors.HOSTED_FIELDS_INVALID_FIELD_SELECTOR.code,message:errors.HOSTED_FIELDS_INVALID_FIELD_SELECTOR.message,details:{fieldSelector:field.selector,fieldKey:key}})}else if(container.querySelector('iframe[name^="braintree-"]')){throw new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME.type,code:errors.HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME.code,message:errors.HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME.message,details:{fieldSelector:field.selector,fieldKey:key}})}if(field.maxlength&&typeof field.maxlength!=="number"){throw new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.type,code:errors.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.code,message:"The value for maxlength must be a number.",details:{fieldKey:key}})}if(field.minlength&&typeof field.minlength!=="number"){throw new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.type,code:errors.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.code,message:"The value for minlength must be a number.",details:{fieldKey:key}})}frame=iFramer({type:key,name:"braintree-hosted-field-"+key,style:constants.defaultIFrameStyle,title:"Secure Credit Card Frame - "+constants.allowedFields[key].label});this._injectedNodes.push.apply(this._injectedNodes,injectFrame(frame,container));this._setupLabelFocus(key,container);fields[key]={frameElement:frame,containerElement:container};frameReadyPromise=new Promise(function(resolve){frameReadyPromiseResolveFunctions[key]=resolve});frameReadyPromises.push(frameReadyPromise);this._state.fields[key]={isEmpty:true,isValid:false,isPotentiallyValid:true,isFocused:false,container:container};setTimeout(function(){if(browserDetection.isIE()||browserDetection.isEdge()){frame.src="about:blank";setTimeout(function(){frame.src=hostedFieldsUrl},0)}else{frame.src=hostedFieldsUrl}},0)}.bind(this));busOptions.orderedFields=fieldsDOMOrder(this._state.fields);if(busOptions.styles){Object.keys(busOptions.styles).forEach(function(selector){var className=busOptions.styles[selector];if(typeof className==="string"){busOptions.styles[selector]=getStylesFromClass(className)}})}this._bus.on(events.READY_FOR_CLIENT,function(reply){self._clientPromise.then(function(client){reply(client)})});this._bus.on(events.CARD_FORM_ENTRY_HAS_BEGUN,function(){analytics.sendEvent(self._clientPromise,"hosted-fields.input.started")});failureTimeout=setTimeout(function(){analytics.sendEvent(self._clientPromise,"custom.hosted-fields.load.timed-out");self._emit("timeout")},INTEGRATION_TIMEOUT_MS);Promise.all(frameReadyPromises).then(function(results){var reply=results[0];clearTimeout(failureTimeout);reply(busOptions);self._emit("ready")});this._bus.on(events.FRAME_READY,function(data,reply){frameReadyPromiseResolveFunctions[data.field](reply)});this._bus.on(events.INPUT_EVENT,createInputEventHandler(fields).bind(this));this._bus.on(events.TRIGGER_INPUT_FOCUS,function(fieldName){var container=fields[fieldName].containerElement;if(browserDetection.isIos()){setTimeout(function(){if(!isVisibleEnough(container)){container.scrollIntoView()}},5)}});this._destructor.registerFunctionForTeardown(function(){var j,node,parent;for(j=0;j<self._injectedNodes.length;j++){node=self._injectedNodes[j];parent=node.parentNode;parent.removeChild(node);classList.remove(parent,constants.externalClasses.FOCUSED,constants.externalClasses.INVALID,constants.externalClasses.VALID)}});this._destructor.registerFunctionForTeardown(function(){var methodNames=methods(HostedFields.prototype).concat(methods(EventEmitter.prototype));convertMethodsToError(self,methodNames)})}HostedFields.prototype=Object.create(EventEmitter.prototype,{constructor:HostedFields});HostedFields.prototype._setupLabelFocus=function(type,container){var labels,i;var shouldSkipLabelFocus=browserDetection.isIos();var bus=this._bus;if(shouldSkipLabelFocus){return}if(container.id==null){return}function triggerFocus(){bus.emit(events.TRIGGER_INPUT_FOCUS,type)}labels=Array.prototype.slice.call(document.querySelectorAll('label[for="'+container.id+'"]'));labels=labels.concat(findParentTags(container,"label"));for(i=0;i<labels.length;i++){labels[i].addEventListener("click",triggerFocus,false)}this._destructor.registerFunctionForTeardown(function(){for(i=0;i<labels.length;i++){labels[i].removeEventListener("click",triggerFocus,false)}})};HostedFields.prototype._attachInvalidFieldContainersToError=function(err){if(!(err.details&&err.details.invalidFieldKeys&&err.details.invalidFieldKeys.length>0)){return}err.details.invalidFields={};err.details.invalidFieldKeys.forEach(function(field){err.details.invalidFields[field]=this._fields[field].containerElement}.bind(this))};HostedFields.prototype.teardown=function(){var self=this;return new Promise(function(resolve,reject){self._destructor.teardown(function(err){analytics.sendEvent(self._clientPromise,"custom.hosted-fields.teardown-completed");if(err){reject(err)}else{resolve()}})})};HostedFields.prototype.tokenize=function(options){var self=this;if(!options){options={}}return new Promise(function(resolve,reject){self._bus.emit(events.TOKENIZATION_REQUEST,options,function(response){var err=response[0];var payload=response[1];if(err){self._attachInvalidFieldContainersToError(err);reject(new BraintreeError(err))}else{resolve(payload)}})})};HostedFields.prototype.addClass=function(field,classname){var err;if(!allowedFields.hasOwnProperty(field)){err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_INVALID.type,code:errors.HOSTED_FIELDS_FIELD_INVALID.code,message:'"'+field+'" is not a valid field. You must use a valid field option when adding a class.'})}else if(!this._fields.hasOwnProperty(field)){err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot add class to "'+field+'" field because it is not part of the current Hosted Fields options.'})}else{this._bus.emit(events.ADD_CLASS,field,classname)}if(err){return Promise.reject(err)}return Promise.resolve()};HostedFields.prototype.removeClass=function(field,classname){var err;if(!allowedFields.hasOwnProperty(field)){err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_INVALID.type,code:errors.HOSTED_FIELDS_FIELD_INVALID.code,message:'"'+field+'" is not a valid field. You must use a valid field option when removing a class.'})}else if(!this._fields.hasOwnProperty(field)){err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot remove class from "'+field+'" field because it is not part of the current Hosted Fields options.'})}else{this._bus.emit(events.REMOVE_CLASS,field,classname)}if(err){return Promise.reject(err)}return Promise.resolve()};HostedFields.prototype.setAttribute=function(options){var attributeErr,err;if(!allowedFields.hasOwnProperty(options.field)){err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_INVALID.type,code:errors.HOSTED_FIELDS_FIELD_INVALID.code,message:'"'+options.field+'" is not a valid field. You must use a valid field option when setting an attribute.'})}else if(!this._fields.hasOwnProperty(options.field)){err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot set attribute for "'+options.field+'" field because it is not part of the current Hosted Fields options.'})}else{attributeErr=attributeValidationError(options.attribute,options.value);if(attributeErr){err=attributeErr}else{this._bus.emit(events.SET_ATTRIBUTE,options.field,options.attribute,options.value)}}if(err){return Promise.reject(err)}return Promise.resolve()};HostedFields.prototype.setMessage=function(options){this._bus.emit(events.SET_MESSAGE,options.field,options.message)};HostedFields.prototype.removeAttribute=function(options){var attributeErr,err;if(!allowedFields.hasOwnProperty(options.field)){err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_INVALID.type,code:errors.HOSTED_FIELDS_FIELD_INVALID.code,message:'"'+options.field+'" is not a valid field. You must use a valid field option when removing an attribute.'})}else if(!this._fields.hasOwnProperty(options.field)){err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot remove attribute for "'+options.field+'" field because it is not part of the current Hosted Fields options.'})}else{attributeErr=attributeValidationError(options.attribute);if(attributeErr){err=attributeErr}else{this._bus.emit(events.REMOVE_ATTRIBUTE,options.field,options.attribute)}}if(err){return Promise.reject(err)}return Promise.resolve()};HostedFields.prototype.setPlaceholder=function(field,placeholder){return this.setAttribute({field:field,attribute:"placeholder",value:placeholder})};HostedFields.prototype.clear=function(field){var err;if(!allowedFields.hasOwnProperty(field)){err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_INVALID.type,code:errors.HOSTED_FIELDS_FIELD_INVALID.code,message:'"'+field+'" is not a valid field. You must use a valid field option when clearing a field.'})}else if(!this._fields.hasOwnProperty(field)){err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot clear "'+field+'" field because it is not part of the current Hosted Fields options.'})}else{this._bus.emit(events.CLEAR_FIELD,field)}if(err){return Promise.reject(err)}return Promise.resolve()};HostedFields.prototype.focus=function(field){var err;if(!allowedFields.hasOwnProperty(field)){err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_INVALID.type,code:errors.HOSTED_FIELDS_FIELD_INVALID.code,message:'"'+field+'" is not a valid field. You must use a valid field option when focusing a field.'})}else if(!this._fields.hasOwnProperty(field)){err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot focus "'+field+'" field because it is not part of the current Hosted Fields options.'})}else{this._bus.emit(events.TRIGGER_INPUT_FOCUS,field)}if(err){return Promise.reject(err)}return Promise.resolve()};HostedFields.prototype.getState=function(){return this._state};module.exports=wrapPromise.wrapPrototype(HostedFields)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../../lib/analytics":44,"../../lib/assign":46,"../../lib/braintree-error":49,"../../lib/bus":52,"../../lib/constants":53,"../../lib/convert-methods-to-error":54,"../../lib/create-assets-url":55,"../../lib/create-deferred-client":57,"../../lib/destructor":58,"../../lib/errors":60,"../../lib/event-emitter":61,"../../lib/methods":64,"../../lib/promise":66,"../../lib/vendor/uuid":69,"../shared/browser-detection":38,"../shared/constants":39,"../shared/errors":40,"../shared/find-parent-tags":41,"../shared/get-card-types":42,"./attribute-validation-error":32,"./compose-url":33,"./get-styles-from-class":34,"./inject-frame":36,"@braintree/class-list":12,"@braintree/iframer":13,"@braintree/wrap-promise":20}],36:[function(_dereq_,module,exports){"use strict";module.exports=function injectFrame(frame,container){var clearboth=document.createElement("div");var fragment=document.createDocumentFragment();clearboth.style.clear="both";fragment.appendChild(frame);fragment.appendChild(clearboth);container.appendChild(fragment);return[frame,clearboth]}},{}],37:[function(_dereq_,module,exports){"use strict";var HostedFields=_dereq_("./external/hosted-fields");var basicComponentVerification=_dereq_("../lib/basic-component-verification");var errors=_dereq_("./shared/errors");var supportsInputFormatting=_dereq_("restricted-input/supports-input-formatting");var wrapPromise=_dereq_("@braintree/wrap-promise");var BraintreeError=_dereq_("../lib/braintree-error");var Promise=_dereq_("../lib/promise");var VERSION="3.45.0";function create(options){return basicComponentVerification.verify({name:"Hosted Fields",authorization:options.authorization,client:options.client}).then(function(){var integration=new HostedFields(options);return new Promise(function(resolve,reject){integration.on("ready",function(){resolve(integration)});integration.on("timeout",function(){reject(new BraintreeError(errors.HOSTED_FIELDS_TIMEOUT))})})})}module.exports={supportsInputFormatting:supportsInputFormatting,create:wrapPromise(create),VERSION:VERSION}},{"../lib/basic-component-verification":47,"../lib/braintree-error":49,"../lib/promise":66,"./external/hosted-fields":35,"./shared/errors":40,"@braintree/wrap-promise":20,"restricted-input/supports-input-formatting":31}],38:[function(_dereq_,module,exports){"use strict";module.exports={isIE:_dereq_("@braintree/browser-detection/is-ie"),isEdge:_dereq_("@braintree/browser-detection/is-edge"),isIe9:_dereq_("@braintree/browser-detection/is-ie9"),isIos:_dereq_("@braintree/browser-detection/is-ios"),isIosWebview:_dereq_("@braintree/browser-detection/is-ios-webview")}},{"@braintree/browser-detection/is-edge":5,"@braintree/browser-detection/is-ie":6,"@braintree/browser-detection/is-ie9":8,"@braintree/browser-detection/is-ios":10,"@braintree/browser-detection/is-ios-webview":9}],39:[function(_dereq_,module,exports){"use strict";var enumerate=_dereq_("../../lib/enumerate");var errors=_dereq_("./errors");var VERSION="3.45.0";var constants={VERSION:VERSION,maxExpirationYearAge:19,externalEvents:{FOCUS:"focus",BLUR:"blur",EMPTY:"empty",NOT_EMPTY:"notEmpty",VALIDITY_CHANGE:"validityChange",CARD_TYPE_CHANGE:"cardTypeChange"},defaultMaxLengths:{number:19,postalCode:8,expirationDate:7,expirationMonth:2,expirationYear:4,cvv:3},externalClasses:{FOCUSED:"braintree-hosted-fields-focused",INVALID:"braintree-hosted-fields-invalid",VALID:"braintree-hosted-fields-valid"},defaultIFrameStyle:{border:"none",width:"100%",height:"100%",float:"left"},tokenizationErrorCodes:{81724:errors.HOSTED_FIELDS_TOKENIZATION_FAIL_ON_DUPLICATE,81736:errors.HOSTED_FIELDS_TOKENIZATION_CVV_VERIFICATION_FAILED},allowedStyles:["-moz-appearance","-moz-osx-font-smoothing","-moz-tap-highlight-color","-moz-transition","-webkit-appearance","-webkit-font-smoothing","-webkit-tap-highlight-color","-webkit-transition","appearance","color","direction","font","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-weight","letter-spacing","line-height","padding","opacity","outline","text-shadow","transition"],allowedFields:{number:{name:"credit-card-number",label:"Credit Card Number"},cvv:{name:"cvv",label:"CVV"},expirationDate:{name:"expiration",label:"Expiration Date"},expirationMonth:{name:"expiration-month",label:"Expiration Month"},expirationYear:{name:"expiration-year",label:"Expiration Year"},postalCode:{name:"postal-code",label:"Postal Code"}},allowedAttributes:{"aria-invalid":"boolean","aria-required":"boolean",disabled:"boolean",placeholder:"string"},autocompleteMappings:{"credit-card-number":"cc-number",expiration:"cc-exp","expiration-month":"cc-exp-month","expiration-year":"cc-exp-year",cvv:"cc-csc","postal-code":"billing postal-code"}};constants.events=enumerate(["READY_FOR_CLIENT","FRAME_READY","CARD_FORM_ENTRY_HAS_BEGUN","VALIDATE_STRICT","CONFIGURATION","TOKENIZATION_REQUEST","INPUT_EVENT","TRIGGER_INPUT_FOCUS","ADD_CLASS","REMOVE_CLASS","SET_ATTRIBUTE","REMOVE_ATTRIBUTE","CLEAR_FIELD","AUTOFILL_EXPIRATION_DATE","SET_MESSAGE"],"hosted-fields:");module.exports=constants},{"../../lib/enumerate":59,"./errors":40}],40:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("../../lib/braintree-error");module.exports={HOSTED_FIELDS_TIMEOUT:{type:BraintreeError.types.UNKNOWN,code:"HOSTED_FIELDS_TIMEOUT",message:"Hosted Fields timed out when attempting to set up."},HOSTED_FIELDS_INVALID_FIELD_KEY:{type:BraintreeError.types.MERCHANT,code:"HOSTED_FIELDS_INVALID_FIELD_KEY"},HOSTED_FIELDS_INVALID_FIELD_SELECTOR:{type:BraintreeError.types.MERCHANT,code:"HOSTED_FIELDS_INVALID_FIELD_SELECTOR",message:"Selector does not reference a valid DOM node."},HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME:{type:BraintreeError.types.MERCHANT,code:"HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME",message:"Element already contains a Braintree iframe."},HOSTED_FIELDS_FIELD_INVALID:{type:BraintreeError.types.MERCHANT,code:"HOSTED_FIELDS_FIELD_INVALID"},HOSTED_FIELDS_FIELD_NOT_PRESENT:{type:BraintreeError.types.MERCHANT,code:"HOSTED_FIELDS_FIELD_NOT_PRESENT"},HOSTED_FIELDS_TOKENIZATION_NETWORK_ERROR:{type:BraintreeError.types.NETWORK,code:"HOSTED_FIELDS_TOKENIZATION_NETWORK_ERROR",message:"A tokenization network error occurred."},HOSTED_FIELDS_TOKENIZATION_FAIL_ON_DUPLICATE:{type:BraintreeError.types.CUSTOMER,code:"HOSTED_FIELDS_TOKENIZATION_FAIL_ON_DUPLICATE",message:"This credit card already exists in the merchant's vault."},HOSTED_FIELDS_TOKENIZATION_CVV_VERIFICATION_FAILED:{type:BraintreeError.types.CUSTOMER,code:"HOSTED_FIELDS_TOKENIZATION_CVV_VERIFICATION_FAILED",message:"CVV verification failed during tokenization."},HOSTED_FIELDS_FAILED_TOKENIZATION:{type:BraintreeError.types.CUSTOMER,code:"HOSTED_FIELDS_FAILED_TOKENIZATION",message:"The supplied card data failed tokenization."},HOSTED_FIELDS_FIELDS_EMPTY:{type:BraintreeError.types.CUSTOMER,code:"HOSTED_FIELDS_FIELDS_EMPTY",message:"All fields are empty. Cannot tokenize empty card fields."},HOSTED_FIELDS_FIELDS_INVALID:{type:BraintreeError.types.CUSTOMER,code:"HOSTED_FIELDS_FIELDS_INVALID",message:"Some payment input fields are invalid. Cannot tokenize invalid card fields."},HOSTED_FIELDS_ATTRIBUTE_NOT_SUPPORTED:{type:BraintreeError.types.MERCHANT,code:"HOSTED_FIELDS_ATTRIBUTE_NOT_SUPPORTED"},HOSTED_FIELDS_ATTRIBUTE_VALUE_NOT_ALLOWED:{type:BraintreeError.types.MERCHANT,code:"HOSTED_FIELDS_ATTRIBUTE_VALUE_NOT_ALLOWED"},HOSTED_FIELDS_FIELD_PROPERTY_INVALID:{type:BraintreeError.types.MERCHANT,code:"HOSTED_FIELDS_FIELD_PROPERTY_INVALID"}}},{"../../lib/braintree-error":49}],41:[function(_dereq_,module,exports){"use strict";function findParentTags(element,tag){var parent=element.parentNode;var parents=[];while(parent!=null){if(parent.tagName!=null&&parent.tagName.toLowerCase()===tag){parents.push(parent)}parent=parent.parentNode}return parents}module.exports=findParentTags},{}],42:[function(_dereq_,module,exports){"use strict";var creditCardType=_dereq_("credit-card-type");module.exports=function(number){var results=creditCardType(number);results.forEach(function(card){if(card.type==="mastercard"){card.type="master-card"}});return results}},{"credit-card-type":21}],43:[function(_dereq_,module,exports){"use strict";var createAuthorizationData=_dereq_("./create-authorization-data");var jsonClone=_dereq_("./json-clone");var constants=_dereq_("./constants");function addMetadata(configuration,data){var key;var attrs=data?jsonClone(data):{};var authAttrs=createAuthorizationData(configuration.authorization).attrs;var _meta=jsonClone(configuration.analyticsMetadata);attrs.braintreeLibraryVersion=constants.BRAINTREE_LIBRARY_VERSION;for(key in attrs._meta){if(attrs._meta.hasOwnProperty(key)){_meta[key]=attrs._meta[key]}}attrs._meta=_meta;if(authAttrs.tokenizationKey){attrs.tokenizationKey=authAttrs.tokenizationKey}else{attrs.authorizationFingerprint=authAttrs.authorizationFingerprint}return attrs}module.exports=addMetadata},{"./constants":53,"./create-authorization-data":56,"./json-clone":63}],44:[function(_dereq_,module,exports){"use strict";var Promise=_dereq_("./promise");var constants=_dereq_("./constants");var addMetadata=_dereq_("./add-metadata");function _millisToSeconds(millis){return Math.floor(millis/1e3)}function sendAnalyticsEvent(clientInstanceOrPromise,kind,callback){var timestamp=_millisToSeconds(Date.now());return Promise.resolve(clientInstanceOrPromise).then(function(client){var timestampInPromise=_millisToSeconds(Date.now());var configuration=client.getConfiguration();var request=client._request;var url=configuration.gatewayConfiguration.analytics.url;var data={analytics:[{kind:constants.ANALYTICS_PREFIX+kind,isAsync:timestampInPromise!==timestamp,timestamp:timestamp}]};request({url:url,method:"post",data:addMetadata(configuration,data),timeout:constants.ANALYTICS_REQUEST_TIMEOUT_MS},callback)})}module.exports={sendEvent:sendAnalyticsEvent}},{"./add-metadata":43,"./constants":53,"./promise":66}],45:[function(_dereq_,module,exports){"use strict";var loadScript=_dereq_("@braintree/asset-loader/load-script");module.exports={loadScript:loadScript}},{"@braintree/asset-loader/load-script":2}],46:[function(_dereq_,module,exports){"use strict";var assignNormalized=typeof Object.assign==="function"?Object.assign:assignPolyfill;function assignPolyfill(destination){var i,source,key;for(i=1;i<arguments.length;i++){source=arguments[i];for(key in source){if(source.hasOwnProperty(key)){destination[key]=source[key]}}}return destination}module.exports={assign:assignNormalized,_assign:assignPolyfill}},{}],47:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("./braintree-error");var Promise=_dereq_("./promise");var sharedErrors=_dereq_("./errors");var VERSION="3.45.0";function basicComponentVerification(options){var client,authorization,name;if(!options){return Promise.reject(new BraintreeError({type:sharedErrors.INVALID_USE_OF_INTERNAL_FUNCTION.type,code:sharedErrors.INVALID_USE_OF_INTERNAL_FUNCTION.code,message:"Options must be passed to basicComponentVerification function."}))}name=options.name;client=options.client;authorization=options.authorization;if(client==null&&authorization==null){return Promise.reject(new BraintreeError({type:sharedErrors.INSTANTIATION_OPTION_REQUIRED.type,code:sharedErrors.INSTANTIATION_OPTION_REQUIRED.code,message:"options.client is required when instantiating "+name+"."}))}if(!authorization&&client.getVersion()!==VERSION){return Promise.reject(new BraintreeError({type:sharedErrors.INCOMPATIBLE_VERSIONS.type,code:sharedErrors.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+client.getVersion()+") and "+name+" (version "+VERSION+") components must be from the same SDK version."}))}return Promise.resolve()}module.exports={verify:basicComponentVerification}},{"./braintree-error":49,"./errors":60,"./promise":66}],48:[function(_dereq_,module,exports){"use strict";var once=_dereq_("./once");function call(fn,callback){var isSync=fn.length===0;if(isSync){fn();callback(null)}else{fn(callback)}}module.exports=function(functions,cb){var i;var length=functions.length;var remaining=length;var callback=once(cb);if(length===0){callback(null);return}function finish(err){if(err){callback(err);return}remaining-=1;if(remaining===0){callback(null)}}for(i=0;i<length;i++){call(functions[i],finish)}}},{"./once":65}],49:[function(_dereq_,module,exports){"use strict";var enumerate=_dereq_("./enumerate");function BraintreeError(options){if(!BraintreeError.types.hasOwnProperty(options.type)){throw new Error(options.type+" is not a valid type.")}if(!options.code){throw new Error("Error code required.")}if(!options.message){throw new Error("Error message required.")}this.name="BraintreeError";this.code=options.code;this.message=options.message;this.type=options.type;this.details=options.details}BraintreeError.prototype=Object.create(Error.prototype);BraintreeError.prototype.constructor=BraintreeError;BraintreeError.types=enumerate(["CUSTOMER","MERCHANT","NETWORK","INTERNAL","UNKNOWN"]);BraintreeError.findRootError=function(err){if(err instanceof BraintreeError&&err.details&&err.details.originalError){return BraintreeError.findRootError(err.details.originalError)}return err};module.exports=BraintreeError},{"./enumerate":59}],50:[function(_dereq_,module,exports){"use strict";var isVerifiedDomain=_dereq_("../is-verified-domain");function checkOrigin(postMessageOrigin,merchantUrl){var merchantOrigin,merchantHost;var a=document.createElement("a");a.href=merchantUrl;if(a.protocol==="https:"){merchantHost=a.host.replace(/:443$/,"")}else if(a.protocol==="http:"){merchantHost=a.host.replace(/:80$/,"")}else{merchantHost=a.host}merchantOrigin=a.protocol+"//"+merchantHost;if(merchantOrigin===postMessageOrigin){return true}a.href=postMessageOrigin;return isVerifiedDomain(postMessageOrigin)}module.exports={checkOrigin:checkOrigin}},{"../is-verified-domain":62}],51:[function(_dereq_,module,exports){"use strict";var enumerate=_dereq_("../enumerate");module.exports=enumerate(["CONFIGURATION_REQUEST"],"bus:")},{"../enumerate":59}],52:[function(_dereq_,module,exports){"use strict";var bus=_dereq_("framebus");var events=_dereq_("./events");var checkOrigin=_dereq_("./check-origin").checkOrigin;var BraintreeError=_dereq_("../braintree-error");function BraintreeBus(options){options=options||{};this.channel=options.channel;if(!this.channel){throw new BraintreeError({type:BraintreeError.types.INTERNAL,code:"MISSING_CHANNEL_ID",message:"Channel ID must be specified."})}this.merchantUrl=options.merchantUrl;this._isDestroyed=false;this._isVerbose=false;this._listeners=[];this._log("new bus on channel "+this.channel,[location.href])}BraintreeBus.prototype.on=function(eventName,originalHandler){var namespacedEvent,args;var handler=originalHandler;var self=this;if(this._isDestroyed){return}if(this.merchantUrl){handler=function(){if(checkOrigin(this.origin,self.merchantUrl)){originalHandler.apply(this,arguments)}}}namespacedEvent=this._namespaceEvent(eventName);args=Array.prototype.slice.call(arguments);args[0]=namespacedEvent;args[1]=handler;this._log("on",args);bus.on.apply(bus,args);this._listeners.push({eventName:eventName,handler:handler,originalHandler:originalHandler})};BraintreeBus.prototype.emit=function(eventName){var args;if(this._isDestroyed){return}args=Array.prototype.slice.call(arguments);args[0]=this._namespaceEvent(eventName);this._log("emit",args);bus.emit.apply(bus,args)};BraintreeBus.prototype._offDirect=function(eventName){var args=Array.prototype.slice.call(arguments);if(this._isDestroyed){return}args[0]=this._namespaceEvent(eventName);this._log("off",args);bus.off.apply(bus,args)};BraintreeBus.prototype.off=function(eventName,originalHandler){var i,listener;var handler=originalHandler;if(this._isDestroyed){return}if(this.merchantUrl){for(i=0;i<this._listeners.length;i++){listener=this._listeners[i];if(listener.originalHandler===originalHandler){handler=listener.handler}}}this._offDirect(eventName,handler)};BraintreeBus.prototype._namespaceEvent=function(eventName){return["braintree",this.channel,eventName].join(":")};BraintreeBus.prototype.teardown=function(){var listener,i;for(i=0;i<this._listeners.length;i++){listener=this._listeners[i];this._offDirect(listener.eventName,listener.handler)}this._listeners.length=0;this._isDestroyed=true};BraintreeBus.prototype._log=function(functionName,args){if(this._isVerbose){console.log(functionName,args)}};BraintreeBus.events=events;module.exports=BraintreeBus},{"../braintree-error":49,"./check-origin":50,"./events":51,framebus:28}],53:[function(_dereq_,module,exports){"use strict";var VERSION="3.45.0";var PLATFORM="web";var CLIENT_API_URLS={production:"https://api.braintreegateway.com:443",sandbox:"https://api.sandbox.braintreegateway.com:443"};var ASSETS_URLS={production:"https://assets.braintreegateway.com",sandbox:"https://assets.braintreegateway.com"};var GRAPHQL_URLS={production:"https://payments.braintree-api.com/graphql",sandbox:"https://payments.sandbox.braintree-api.com/graphql"};module.exports={ANALYTICS_PREFIX:PLATFORM+".",ANALYTICS_REQUEST_TIMEOUT_MS:2e3,ASSETS_URLS:ASSETS_URLS,CLIENT_API_URLS:CLIENT_API_URLS,FRAUDNET_SOURCE:"BRAINTREE_SIGNIN",FRAUDNET_FNCLS:"fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99",FRAUDNET_URL:"https://c.paypal.com/da/r/fb.js",GRAPHQL_URLS:GRAPHQL_URLS,INTEGRATION_TIMEOUT_MS:6e4,VERSION:VERSION,INTEGRATION:"custom",SOURCE:"client",PLATFORM:PLATFORM,BRAINTREE_LIBRARY_VERSION:"braintree/"+PLATFORM+"/"+VERSION}},{}],54:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("./braintree-error");var sharedErrors=_dereq_("./errors");module.exports=function(instance,methodNames){methodNames.forEach(function(methodName){instance[methodName]=function(){throw new BraintreeError({type:sharedErrors.METHOD_CALLED_AFTER_TEARDOWN.type,code:sharedErrors.METHOD_CALLED_AFTER_TEARDOWN.code,message:methodName+" cannot be called after teardown."})}})}},{"./braintree-error":49,"./errors":60}],55:[function(_dereq_,module,exports){"use strict";var ASSETS_URLS=_dereq_("./constants").ASSETS_URLS;function createAssetsUrl(authorization){return ASSETS_URLS.production}module.exports={create:createAssetsUrl}},{"./constants":53}],56:[function(_dereq_,module,exports){"use strict";var atob=_dereq_("../lib/vendor/polyfill").atob;var CLIENT_API_URLS=_dereq_("../lib/constants").CLIENT_API_URLS;function _isTokenizationKey(str){return/^[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9_]+$/.test(str)}function _parseTokenizationKey(tokenizationKey){var tokens=tokenizationKey.split("_");var environment=tokens[0];var merchantId=tokens.slice(2).join("_");return{merchantId:merchantId,environment:environment}}function createAuthorizationData(authorization){var parsedClientToken,parsedTokenizationKey;var data={attrs:{},configUrl:""};if(_isTokenizationKey(authorization)){parsedTokenizationKey=_parseTokenizationKey(authorization);data.environment=parsedTokenizationKey.environment;data.attrs.tokenizationKey=authorization;data.configUrl=CLIENT_API_URLS[parsedTokenizationKey.environment]+"/merchants/"+parsedTokenizationKey.merchantId+"/client_api/v1/configuration"}else{parsedClientToken=JSON.parse(atob(authorization));data.environment=parsedClientToken.environment;data.attrs.authorizationFingerprint=parsedClientToken.authorizationFingerprint;data.configUrl=parsedClientToken.configUrl;data.graphQL=parsedClientToken.graphQL}return data}module.exports=createAuthorizationData},{"../lib/constants":53,"../lib/vendor/polyfill":68}],57:[function(_dereq_,module,exports){(function(global){"use strict";var BraintreeError=_dereq_("./braintree-error");var Promise=_dereq_("./promise");var assets=_dereq_("./assets");var sharedErrors=_dereq_("./errors");var VERSION="3.45.0";function createDeferredClient(options){var promise=Promise.resolve();if(options.client){return Promise.resolve(options.client)}if(!(global.braintree&&global.braintree.client)){promise=assets.loadScript({src:options.assetsUrl+"/web/"+VERSION+"/js/client.min.js"}).catch(function(err){return Promise.reject(new BraintreeError({type:sharedErrors.CLIENT_SCRIPT_FAILED_TO_LOAD.type,code:sharedErrors.CLIENT_SCRIPT_FAILED_TO_LOAD.code,message:sharedErrors.CLIENT_SCRIPT_FAILED_TO_LOAD.message,details:{originalError:err}}))})}return promise.then(function(){if(global.braintree.client.VERSION!==VERSION){return Promise.reject(new BraintreeError({type:sharedErrors.INCOMPATIBLE_VERSIONS.type,code:sharedErrors.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+global.braintree.client.VERSION+") and "+options.name+" (version "+VERSION+") components must be from the same SDK version."}))}return global.braintree.client.create({authorization:options.authorization,debug:options.debug})})}module.exports={create:createDeferredClient}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./assets":45,"./braintree-error":49,"./errors":60,"./promise":66}],58:[function(_dereq_,module,exports){"use strict";var batchExecuteFunctions=_dereq_("./batch-execute-functions");function Destructor(){this._teardownRegistry=[];this._isTearingDown=false}Destructor.prototype.registerFunctionForTeardown=function(fn){if(typeof fn==="function"){this._teardownRegistry.push(fn)}};Destructor.prototype.teardown=function(callback){if(this._isTearingDown){callback(new Error("Destructor is already tearing down"));return}this._isTearingDown=true;batchExecuteFunctions(this._teardownRegistry,function(err){this._teardownRegistry=[];this._isTearingDown=false;if(typeof callback==="function"){callback(err)}}.bind(this))};module.exports=Destructor},{"./batch-execute-functions":48}],59:[function(_dereq_,module,exports){"use strict";function enumerate(values,prefix){prefix=prefix==null?"":prefix;return values.reduce(function(enumeration,value){enumeration[value]=prefix+value;return enumeration},{})}module.exports=enumerate},{}],60:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("./braintree-error");module.exports={INVALID_USE_OF_INTERNAL_FUNCTION:{type:BraintreeError.types.INTERNAL,code:"INVALID_USE_OF_INTERNAL_FUNCTION"},INSTANTIATION_OPTION_REQUIRED:{type:BraintreeError.types.MERCHANT,code:"INSTANTIATION_OPTION_REQUIRED"},INCOMPATIBLE_VERSIONS:{type:BraintreeError.types.MERCHANT,code:"INCOMPATIBLE_VERSIONS"},CLIENT_SCRIPT_FAILED_TO_LOAD:{type:BraintreeError.types.NETWORK,code:"CLIENT_SCRIPT_FAILED_TO_LOAD",message:"Braintree client script could not be loaded."},METHOD_CALLED_AFTER_TEARDOWN:{type:BraintreeError.types.MERCHANT,code:"METHOD_CALLED_AFTER_TEARDOWN"},BRAINTREE_API_ACCESS_RESTRICTED:{type:BraintreeError.types.MERCHANT,code:"BRAINTREE_API_ACCESS_RESTRICTED",message:"Your access is restricted and cannot use this part of the Braintree API."}}},{"./braintree-error":49}],61:[function(_dereq_,module,exports){"use strict";function EventEmitter(){this._events={}}EventEmitter.prototype.on=function(event,callback){if(this._events[event]){this._events[event].push(callback)}else{this._events[event]=[callback]}};EventEmitter.prototype._emit=function(event){var i,args;var callbacks=this._events[event];if(!callbacks){return}args=Array.prototype.slice.call(arguments,1);for(i=0;i<callbacks.length;i++){callbacks[i].apply(null,args)}};module.exports=EventEmitter},{}],62:[function(_dereq_,module,exports){"use strict";var parser;var legalHosts={"paypal.com":1,"braintreepayments.com":1,"braintreegateway.com":1,"braintree-api.com":1};function stripSubdomains(domain){return domain.split(".").slice(-2).join(".")}function isVerifiedDomain(url){var mainDomain;url=url.toLowerCase();if(!/^https:/.test(url)){return false}parser=parser||document.createElement("a");parser.href=url;mainDomain=stripSubdomains(parser.hostname);return legalHosts.hasOwnProperty(mainDomain)}module.exports=isVerifiedDomain},{}],63:[function(_dereq_,module,exports){"use strict";module.exports=function(value){return JSON.parse(JSON.stringify(value))}},{}],64:[function(_dereq_,module,exports){"use strict";module.exports=function(obj){return Object.keys(obj).filter(function(key){return typeof obj[key]==="function"})}},{}],65:[function(_dereq_,module,exports){arguments[4][18][0].apply(exports,arguments)},{dup:18}],66:[function(_dereq_,module,exports){(function(global){"use strict";var Promise=global.Promise||_dereq_("promise-polyfill");module.exports=Promise}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"promise-polyfill":29}],67:[function(_dereq_,module,exports){"use strict";function useMin(isDebug){return isDebug?"":".min"}module.exports=useMin},{}],68:[function(_dereq_,module,exports){(function(global){"use strict";var atobNormalized=typeof global.atob==="function"?global.atob:atob;function atob(base64String){var a,b,c,b1,b2,b3,b4,i;var base64Matcher=new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})([=]{1,2})?$");var characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var result="";if(!base64Matcher.test(base64String)){throw new Error("Non base64 encoded input passed to window.atob polyfill")}i=0;do{b1=characters.indexOf(base64String.charAt(i++));b2=characters.indexOf(base64String.charAt(i++));b3=characters.indexOf(base64String.charAt(i++));b4=characters.indexOf(base64String.charAt(i++));a=(b1&63)<<2|b2>>4&3;b=(b2&15)<<4|b3>>2&15;c=(b3&3)<<6|b4&63;result+=String.fromCharCode(a)+(b?String.fromCharCode(b):"")+(c?String.fromCharCode(c):"")}while(i<base64String.length);return result}module.exports={atob:function(base64String){return atobNormalized.call(global,base64String)},_atob:atob}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],69:[function(_dereq_,module,exports){"use strict";function uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0;var v=c==="x"?r:r&3|8;return v.toString(16)})}module.exports=uuid},{}]},{},[37])(37)});(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}(g.braintree||(g.braintree={})).paypalCheckout=f()}})(function(){var define,module,exports;return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(_dereq_,module,exports){(function(global){"use strict";var PromisePolyfill=_dereq_("promise-polyfill");module.exports=global.Promise||PromisePolyfill}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"promise-polyfill":7}],2:[function(_dereq_,module,exports){"use strict";var Promise=_dereq_("./lib/promise");var scriptPromiseCache={};function loadScript(options){var attrs,container,script,scriptLoadPromise;var stringifiedOptions=JSON.stringify(options);if(!options.forceScriptReload){scriptLoadPromise=scriptPromiseCache[stringifiedOptions];if(scriptLoadPromise){return scriptLoadPromise}}script=document.createElement("script");attrs=options.dataAttributes||{};container=options.container||document.head;script.src=options.src;script.id=options.id;script.async=true;Object.keys(attrs).forEach(function(key){script.setAttribute("data-"+key,attrs[key])});scriptLoadPromise=new Promise(function(resolve,reject){script.addEventListener("load",function(){resolve(script)});script.addEventListener("error",function(){reject(new Error(options.src+" failed to load."))});script.addEventListener("abort",function(){reject(new Error(options.src+" has aborted."))});container.appendChild(script)});scriptPromiseCache[stringifiedOptions]=scriptLoadPromise;return scriptLoadPromise}loadScript.clearCache=function(){scriptPromiseCache={}};module.exports=loadScript},{"./lib/promise":1}],3:[function(_dereq_,module,exports){"use strict";function deferred(fn){return function(){var args=arguments;setTimeout(function(){try{fn.apply(null,args)}catch(err){console.log("Error in callback function");console.log(err)}},1)}}module.exports=deferred},{}],4:[function(_dereq_,module,exports){"use strict";function once(fn){var called=false;return function(){if(!called){called=true;fn.apply(null,arguments)}}}module.exports=once},{}],5:[function(_dereq_,module,exports){"use strict";function promiseOrCallback(promise,callback){if(callback){promise.then(function(data){callback(null,data)}).catch(function(err){callback(err)})}else{return promise}}module.exports=promiseOrCallback},{}],6:[function(_dereq_,module,exports){"use strict";var deferred=_dereq_("./lib/deferred");var once=_dereq_("./lib/once");var promiseOrCallback=_dereq_("./lib/promise-or-callback");function wrapPromise(fn){return function(){var callback;var args=Array.prototype.slice.call(arguments);var lastArg=args[args.length-1];if(typeof lastArg==="function"){callback=args.pop();callback=once(deferred(callback))}return promiseOrCallback(fn.apply(this,args),callback)}}wrapPromise.wrapPrototype=function(target,options){var methods,ignoreMethods,includePrivateMethods;options=options||{};ignoreMethods=options.ignoreMethods||[];includePrivateMethods=options.transformPrivateMethods===true;methods=Object.getOwnPropertyNames(target.prototype).filter(function(method){var isNotPrivateMethod;var isNonConstructorFunction=method!=="constructor"&&typeof target.prototype[method]==="function";var isNotAnIgnoredMethod=ignoreMethods.indexOf(method)===-1;if(includePrivateMethods){isNotPrivateMethod=true}else{isNotPrivateMethod=method.charAt(0)!=="_"}return isNonConstructorFunction&&isNotPrivateMethod&&isNotAnIgnoredMethod});methods.forEach(function(method){var original=target.prototype[method];target.prototype[method]=wrapPromise(original)});return target};module.exports=wrapPromise},{"./lib/deferred":3,"./lib/once":4,"./lib/promise-or-callback":5}],7:[function(_dereq_,module,exports){"use strict";function finallyConstructor(callback){var constructor=this.constructor;return this.then(function(value){return constructor.resolve(callback()).then(function(){return value})},function(reason){return constructor.resolve(callback()).then(function(){return constructor.reject(reason)})})}var setTimeoutFunc=setTimeout;function noop(){}function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function Promise(fn){if(!(this instanceof Promise))throw new TypeError("Promises must be constructed via new");if(typeof fn!=="function")throw new TypeError("not a function");this._state=0;this._handled=false;this._value=undefined;this._deferreds=[];doResolve(fn,this)}function handle(self,deferred){while(self._state===3){self=self._value}if(self._state===0){self._deferreds.push(deferred);return}self._handled=true;Promise._immediateFn(function(){var cb=self._state===1?deferred.onFulfilled:deferred.onRejected;if(cb===null){(self._state===1?resolve:reject)(deferred.promise,self._value);return}var ret;try{ret=cb(self._value)}catch(e){reject(deferred.promise,e);return}resolve(deferred.promise,ret)})}function resolve(self,newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&(typeof newValue==="object"||typeof newValue==="function")){var then=newValue.then;if(newValue instanceof Promise){self._state=3;self._value=newValue;finale(self);return}else if(typeof then==="function"){doResolve(bind(then,newValue),self);return}}self._state=1;self._value=newValue;finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2;self._value=newValue;finale(self)}function finale(self){if(self._state===2&&self._deferreds.length===0){Promise._immediateFn(function(){if(!self._handled){Promise._unhandledRejectionFn(self._value)}})}for(var i=0,len=self._deferreds.length;i<len;i++){handle(self,self._deferreds[i])}self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled=typeof onFulfilled==="function"?onFulfilled:null;this.onRejected=typeof onRejected==="function"?onRejected:null;this.promise=promise}function doResolve(fn,self){var done=false;try{fn(function(value){if(done)return;done=true;resolve(self,value)},function(reason){if(done)return;done=true;reject(self,reason)})}catch(ex){if(done)return;done=true;reject(self,ex)}}Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected)};Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);handle(this,new Handler(onFulfilled,onRejected,prom));return prom};Promise.prototype["finally"]=finallyConstructor;Promise.all=function(arr){return new Promise(function(resolve,reject){if(!arr||typeof arr.length==="undefined")throw new TypeError("Promise.all accepts an array");var args=Array.prototype.slice.call(arr);if(args.length===0)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&(typeof val==="object"||typeof val==="function")){var then=val.then;if(typeof then==="function"){then.call(val,function(val){res(i,val)},reject);return}}args[i]=val;if(--remaining===0){resolve(args)}}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++){res(i,args[i])}})};Promise.resolve=function(value){if(value&&typeof value==="object"&&value.constructor===Promise){return value}return new Promise(function(resolve){resolve(value)})};Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})};Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++){values[i].then(resolve,reject)}})};Promise._immediateFn=typeof setImmediate==="function"&&function(fn){setImmediate(fn)}||function(fn){setTimeoutFunc(fn,0)};Promise._unhandledRejectionFn=function _unhandledRejectionFn(err){if(typeof console!=="undefined"&&console){console.warn("Possible Unhandled Promise Rejection:",err)}};module.exports=Promise},{}],8:[function(_dereq_,module,exports){"use strict";var createAuthorizationData=_dereq_("./create-authorization-data");var jsonClone=_dereq_("./json-clone");var constants=_dereq_("./constants");function addMetadata(configuration,data){var key;var attrs=data?jsonClone(data):{};var authAttrs=createAuthorizationData(configuration.authorization).attrs;var _meta=jsonClone(configuration.analyticsMetadata);attrs.braintreeLibraryVersion=constants.BRAINTREE_LIBRARY_VERSION;for(key in attrs._meta){if(attrs._meta.hasOwnProperty(key)){_meta[key]=attrs._meta[key]}}attrs._meta=_meta;if(authAttrs.tokenizationKey){attrs.tokenizationKey=authAttrs.tokenizationKey}else{attrs.authorizationFingerprint=authAttrs.authorizationFingerprint}return attrs}module.exports=addMetadata},{"./constants":13,"./create-authorization-data":17,"./json-clone":21}],9:[function(_dereq_,module,exports){"use strict";var Promise=_dereq_("./promise");var constants=_dereq_("./constants");var addMetadata=_dereq_("./add-metadata");function _millisToSeconds(millis){return Math.floor(millis/1e3)}function sendAnalyticsEvent(clientInstanceOrPromise,kind,callback){var timestamp=_millisToSeconds(Date.now());return Promise.resolve(clientInstanceOrPromise).then(function(client){var timestampInPromise=_millisToSeconds(Date.now());var configuration=client.getConfiguration();var request=client._request;var url=configuration.gatewayConfiguration.analytics.url;var data={analytics:[{kind:constants.ANALYTICS_PREFIX+kind,isAsync:timestampInPromise!==timestamp,timestamp:timestamp}]};request({url:url,method:"post",data:addMetadata(configuration,data),timeout:constants.ANALYTICS_REQUEST_TIMEOUT_MS},callback)})}module.exports={sendEvent:sendAnalyticsEvent}},{"./add-metadata":8,"./constants":13,"./promise":23}],10:[function(_dereq_,module,exports){"use strict";var loadScript=_dereq_("@braintree/asset-loader/load-script");module.exports={loadScript:loadScript}},{"@braintree/asset-loader/load-script":2}],11:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("./braintree-error");var Promise=_dereq_("./promise");var sharedErrors=_dereq_("./errors");var VERSION="3.45.0";function basicComponentVerification(options){var client,authorization,name;if(!options){return Promise.reject(new BraintreeError({type:sharedErrors.INVALID_USE_OF_INTERNAL_FUNCTION.type,code:sharedErrors.INVALID_USE_OF_INTERNAL_FUNCTION.code,message:"Options must be passed to basicComponentVerification function."}))}name=options.name;client=options.client;authorization=options.authorization;if(client==null&&authorization==null){return Promise.reject(new BraintreeError({type:sharedErrors.INSTANTIATION_OPTION_REQUIRED.type,code:sharedErrors.INSTANTIATION_OPTION_REQUIRED.code,message:"options.client is required when instantiating "+name+"."}))}if(!authorization&&client.getVersion()!==VERSION){return Promise.reject(new BraintreeError({type:sharedErrors.INCOMPATIBLE_VERSIONS.type,code:sharedErrors.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+client.getVersion()+") and "+name+" (version "+VERSION+") components must be from the same SDK version."}))}return Promise.resolve()}module.exports={verify:basicComponentVerification}},{"./braintree-error":12,"./errors":20,"./promise":23}],12:[function(_dereq_,module,exports){"use strict";var enumerate=_dereq_("./enumerate");function BraintreeError(options){if(!BraintreeError.types.hasOwnProperty(options.type)){throw new Error(options.type+" is not a valid type.")}if(!options.code){throw new Error("Error code required.")}if(!options.message){throw new Error("Error message required.")}this.name="BraintreeError";this.code=options.code;this.message=options.message;this.type=options.type;this.details=options.details}BraintreeError.prototype=Object.create(Error.prototype);BraintreeError.prototype.constructor=BraintreeError;BraintreeError.types=enumerate(["CUSTOMER","MERCHANT","NETWORK","INTERNAL","UNKNOWN"]);BraintreeError.findRootError=function(err){if(err instanceof BraintreeError&&err.details&&err.details.originalError){return BraintreeError.findRootError(err.details.originalError)}return err};module.exports=BraintreeError},{"./enumerate":19}],13:[function(_dereq_,module,exports){"use strict";var VERSION="3.45.0";var PLATFORM="web";var CLIENT_API_URLS={production:"https://api.braintreegateway.com:443",sandbox:"https://api.sandbox.braintreegateway.com:443"};var ASSETS_URLS={production:"https://assets.braintreegateway.com",sandbox:"https://assets.braintreegateway.com"};var GRAPHQL_URLS={production:"https://payments.braintree-api.com/graphql",sandbox:"https://payments.sandbox.braintree-api.com/graphql"};module.exports={ANALYTICS_PREFIX:PLATFORM+".",ANALYTICS_REQUEST_TIMEOUT_MS:2e3,ASSETS_URLS:ASSETS_URLS,CLIENT_API_URLS:CLIENT_API_URLS,FRAUDNET_SOURCE:"BRAINTREE_SIGNIN",FRAUDNET_FNCLS:"fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99",FRAUDNET_URL:"https://c.paypal.com/da/r/fb.js",GRAPHQL_URLS:GRAPHQL_URLS,INTEGRATION_TIMEOUT_MS:6e4,VERSION:VERSION,INTEGRATION:"custom",SOURCE:"client",PLATFORM:PLATFORM,BRAINTREE_LIBRARY_VERSION:"braintree/"+PLATFORM+"/"+VERSION}},{}],14:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("./braintree-error");var sharedErrors=_dereq_("./errors");module.exports=function(instance,methodNames){methodNames.forEach(function(methodName){instance[methodName]=function(){throw new BraintreeError({type:sharedErrors.METHOD_CALLED_AFTER_TEARDOWN.type,code:sharedErrors.METHOD_CALLED_AFTER_TEARDOWN.code,message:methodName+" cannot be called after teardown."})}})}},{"./braintree-error":12,"./errors":20}],15:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("./braintree-error");function convertToBraintreeError(originalErr,btErrorObject){if(originalErr instanceof BraintreeError){return originalErr}return new BraintreeError({type:btErrorObject.type,code:btErrorObject.code,message:btErrorObject.message,details:{originalError:originalErr}})}module.exports=convertToBraintreeError},{"./braintree-error":12}],16:[function(_dereq_,module,exports){"use strict";var ASSETS_URLS=_dereq_("./constants").ASSETS_URLS;function createAssetsUrl(authorization){return ASSETS_URLS.production}module.exports={create:createAssetsUrl}},{"./constants":13}],17:[function(_dereq_,module,exports){"use strict";var atob=_dereq_("../lib/vendor/polyfill").atob;var CLIENT_API_URLS=_dereq_("../lib/constants").CLIENT_API_URLS;function _isTokenizationKey(str){return/^[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9_]+$/.test(str)}function _parseTokenizationKey(tokenizationKey){var tokens=tokenizationKey.split("_");var environment=tokens[0];var merchantId=tokens.slice(2).join("_");return{merchantId:merchantId,environment:environment}}function createAuthorizationData(authorization){var parsedClientToken,parsedTokenizationKey;var data={attrs:{},configUrl:""};if(_isTokenizationKey(authorization)){parsedTokenizationKey=_parseTokenizationKey(authorization);data.environment=parsedTokenizationKey.environment;data.attrs.tokenizationKey=authorization;data.configUrl=CLIENT_API_URLS[parsedTokenizationKey.environment]+"/merchants/"+parsedTokenizationKey.merchantId+"/client_api/v1/configuration"}else{parsedClientToken=JSON.parse(atob(authorization));data.environment=parsedClientToken.environment;data.attrs.authorizationFingerprint=parsedClientToken.authorizationFingerprint;data.configUrl=parsedClientToken.configUrl;data.graphQL=parsedClientToken.graphQL}return data}module.exports=createAuthorizationData},{"../lib/constants":13,"../lib/vendor/polyfill":24}],18:[function(_dereq_,module,exports){(function(global){"use strict";var BraintreeError=_dereq_("./braintree-error");var Promise=_dereq_("./promise");var assets=_dereq_("./assets");var sharedErrors=_dereq_("./errors");var VERSION="3.45.0";function createDeferredClient(options){var promise=Promise.resolve();if(options.client){return Promise.resolve(options.client)}if(!(global.braintree&&global.braintree.client)){promise=assets.loadScript({src:options.assetsUrl+"/web/"+VERSION+"/js/client.min.js"}).catch(function(err){return Promise.reject(new BraintreeError({type:sharedErrors.CLIENT_SCRIPT_FAILED_TO_LOAD.type,code:sharedErrors.CLIENT_SCRIPT_FAILED_TO_LOAD.code,message:sharedErrors.CLIENT_SCRIPT_FAILED_TO_LOAD.message,details:{originalError:err}}))})}return promise.then(function(){if(global.braintree.client.VERSION!==VERSION){return Promise.reject(new BraintreeError({type:sharedErrors.INCOMPATIBLE_VERSIONS.type,code:sharedErrors.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+global.braintree.client.VERSION+") and "+options.name+" (version "+VERSION+") components must be from the same SDK version."}))}return global.braintree.client.create({authorization:options.authorization,debug:options.debug})})}module.exports={create:createDeferredClient}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./assets":10,"./braintree-error":12,"./errors":20,"./promise":23}],19:[function(_dereq_,module,exports){"use strict";function enumerate(values,prefix){prefix=prefix==null?"":prefix;return values.reduce(function(enumeration,value){enumeration[value]=prefix+value;return enumeration},{})}module.exports=enumerate},{}],20:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("./braintree-error");module.exports={INVALID_USE_OF_INTERNAL_FUNCTION:{type:BraintreeError.types.INTERNAL,code:"INVALID_USE_OF_INTERNAL_FUNCTION"},INSTANTIATION_OPTION_REQUIRED:{type:BraintreeError.types.MERCHANT,code:"INSTANTIATION_OPTION_REQUIRED"},INCOMPATIBLE_VERSIONS:{type:BraintreeError.types.MERCHANT,code:"INCOMPATIBLE_VERSIONS"},CLIENT_SCRIPT_FAILED_TO_LOAD:{type:BraintreeError.types.NETWORK,code:"CLIENT_SCRIPT_FAILED_TO_LOAD",message:"Braintree client script could not be loaded."},METHOD_CALLED_AFTER_TEARDOWN:{type:BraintreeError.types.MERCHANT,code:"METHOD_CALLED_AFTER_TEARDOWN"},BRAINTREE_API_ACCESS_RESTRICTED:{type:BraintreeError.types.MERCHANT,code:"BRAINTREE_API_ACCESS_RESTRICTED",message:"Your access is restricted and cannot use this part of the Braintree API."}}},{"./braintree-error":12}],21:[function(_dereq_,module,exports){"use strict";module.exports=function(value){return JSON.parse(JSON.stringify(value))}},{}],22:[function(_dereq_,module,exports){"use strict";module.exports=function(obj){return Object.keys(obj).filter(function(key){return typeof obj[key]==="function"})}},{}],23:[function(_dereq_,module,exports){(function(global){"use strict";var Promise=global.Promise||_dereq_("promise-polyfill");module.exports=Promise}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"promise-polyfill":7}],24:[function(_dereq_,module,exports){(function(global){"use strict";var atobNormalized=typeof global.atob==="function"?global.atob:atob;function atob(base64String){var a,b,c,b1,b2,b3,b4,i;var base64Matcher=new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})([=]{1,2})?$");var characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var result="";if(!base64Matcher.test(base64String)){throw new Error("Non base64 encoded input passed to window.atob polyfill")}i=0;do{b1=characters.indexOf(base64String.charAt(i++));b2=characters.indexOf(base64String.charAt(i++));b3=characters.indexOf(base64String.charAt(i++));b4=characters.indexOf(base64String.charAt(i++));a=(b1&63)<<2|b2>>4&3;b=(b2&15)<<4|b3>>2&15;c=(b3&3)<<6|b4&63;result+=String.fromCharCode(a)+(b?String.fromCharCode(b):"")+(c?String.fromCharCode(c):"")}while(i<base64String.length);return result}module.exports={atob:function(base64String){return atobNormalized.call(global,base64String)},_atob:atob}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],25:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("../lib/braintree-error");module.exports={PAYPAL_NOT_ENABLED:{type:BraintreeError.types.MERCHANT,code:"PAYPAL_NOT_ENABLED",message:"PayPal is not enabled for this merchant."},PAYPAL_SANDBOX_ACCOUNT_NOT_LINKED:{type:BraintreeError.types.MERCHANT,code:"PAYPAL_SANDBOX_ACCOUNT_NOT_LINKED",message:"A linked PayPal Sandbox account is required to use PayPal Checkout in Sandbox. See https://developers.braintreepayments.com/guides/paypal/testing-go-live/#linked-paypal-testing for details on linking your PayPal sandbox with Braintree."},PAYPAL_ACCOUNT_TOKENIZATION_FAILED:{type:BraintreeError.types.NETWORK,code:"PAYPAL_ACCOUNT_TOKENIZATION_FAILED",message:"Could not tokenize user's PayPal account."},PAYPAL_FLOW_FAILED:{type:BraintreeError.types.NETWORK,code:"PAYPAL_FLOW_FAILED",message:"Could not initialize PayPal flow."},PAYPAL_FLOW_OPTION_REQUIRED:{type:BraintreeError.types.MERCHANT,code:"PAYPAL_FLOW_OPTION_REQUIRED",message:"PayPal flow property is invalid or missing."},PAYPAL_INVALID_PAYMENT_OPTION:{type:BraintreeError.types.MERCHANT,code:"PAYPAL_INVALID_PAYMENT_OPTION",message:"PayPal payment options are invalid."}}},{"../lib/braintree-error":12}],26:[function(_dereq_,module,exports){"use strict";var basicComponentVerification=_dereq_("../lib/basic-component-verification");var wrapPromise=_dereq_("@braintree/wrap-promise");var PayPalCheckout=_dereq_("./paypal-checkout");var VERSION="3.45.0";function create(options){var name="PayPal Checkout";return basicComponentVerification.verify({name:name,client:options.client,authorization:options.authorization}).then(function(){var instance=new PayPalCheckout(options);return instance._initialize(options)})}function isSupported(){return true}module.exports={create:wrapPromise(create),isSupported:isSupported,VERSION:VERSION}},{"../lib/basic-component-verification":11,"./paypal-checkout":27,"@braintree/wrap-promise":6}],27:[function(_dereq_,module,exports){"use strict";var analytics=_dereq_("../lib/analytics");var createDeferredClient=_dereq_("../lib/create-deferred-client");var createAssetsUrl=_dereq_("../lib/create-assets-url");var Promise=_dereq_("../lib/promise");var wrapPromise=_dereq_("@braintree/wrap-promise");var BraintreeError=_dereq_("../lib/braintree-error");var convertToBraintreeError=_dereq_("../lib/convert-to-braintree-error");var errors=_dereq_("./errors");var constants=_dereq_("../paypal/shared/constants");var methods=_dereq_("../lib/methods");var convertMethodsToError=_dereq_("../lib/convert-methods-to-error");function PayPalCheckout(options){this._merchantAccountId=options.merchantAccountId}PayPalCheckout.prototype._initialize=function(options){this._clientPromise=createDeferredClient.create({authorization:options.authorization,client:options.client,debug:options.debug,assetsUrl:createAssetsUrl.create(options.authorization),name:"PayPal Checkout"}).then(function(client){this._configuration=client.getConfiguration();if(!this._merchantAccountId){if(!this._configuration.gatewayConfiguration.paypalEnabled){this._setupError=new BraintreeError(errors.PAYPAL_NOT_ENABLED)}else if(this._configuration.gatewayConfiguration.paypal.environmentNoNetwork===true){this._setupError=new BraintreeError(errors.PAYPAL_SANDBOX_ACCOUNT_NOT_LINKED)}}if(this._setupError){return Promise.reject(this._setupError)}analytics.sendEvent(client,"paypal-checkout.initialized");return client}.bind(this));if(options.client){return this._clientPromise.then(function(){return this}.bind(this))}return Promise.resolve(this)};PayPalCheckout.prototype.createPayment=function(options){var self=this;var endpoint;if(!options||!constants.FLOW_ENDPOINTS.hasOwnProperty(options.flow)){return Promise.reject(new BraintreeError(errors.PAYPAL_FLOW_OPTION_REQUIRED))}endpoint="paypal_hermes/"+constants.FLOW_ENDPOINTS[options.flow];analytics.sendEvent(this._clientPromise,"paypal-checkout.createPayment");if(options.offerCredit===true){analytics.sendEvent(this._clientPromise,"paypal-checkout.credit.offered")}return this._clientPromise.then(function(client){return client.request({endpoint:endpoint,method:"post",data:self._formatPaymentResourceData(options)})}).then(function(response){var flowToken;if(options.flow==="checkout"){flowToken=response.paymentResource.redirectUrl.match(/EC-\w+/)[0]}else{flowToken=response.agreementSetup.tokenId}return flowToken}).catch(function(err){var status;if(self._setupError){return Promise.reject(self._setupError)}status=err.details&&err.details.httpStatus;if(status===422){return Promise.reject(new BraintreeError({type:errors.PAYPAL_INVALID_PAYMENT_OPTION.type,code:errors.PAYPAL_INVALID_PAYMENT_OPTION.code,message:errors.PAYPAL_INVALID_PAYMENT_OPTION.message,details:{originalError:err}}))}return Promise.reject(convertToBraintreeError(err,{type:errors.PAYPAL_FLOW_FAILED.type,code:errors.PAYPAL_FLOW_FAILED.code,message:errors.PAYPAL_FLOW_FAILED.message}))})};PayPalCheckout.prototype.tokenizePayment=function(tokenizeOptions){var self=this;var payload;var options={flow:tokenizeOptions.billingToken?"vault":"checkout",intent:tokenizeOptions.intent};var params={ecToken:tokenizeOptions.paymentToken,billingToken:tokenizeOptions.billingToken,payerId:tokenizeOptions.payerID,paymentId:tokenizeOptions.paymentID};analytics.sendEvent(this._clientPromise,"paypal-checkout.tokenization.started");return this._clientPromise.then(function(client){return client.request({endpoint:"payment_methods/paypal_accounts",method:"post",data:self._formatTokenizeData(options,params)})}).then(function(response){payload=self._formatTokenizePayload(response);analytics.sendEvent(self._clientPromise,"paypal-checkout.tokenization.success");if(payload.creditFinancingOffered){analytics.sendEvent(self._clientPromise,"paypal-checkout.credit.accepted")}return payload}).catch(function(err){if(self._setupError){return Promise.reject(self._setupError)}analytics.sendEvent(self._clientPromise,"paypal-checkout.tokenization.failed");return Promise.reject(convertToBraintreeError(err,{type:errors.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.type,code:errors.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.code,message:errors.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.message}))})};PayPalCheckout.prototype._formatPaymentResourceData=function(options){var key;var gatewayConfiguration=this._configuration.gatewayConfiguration;var intent=options.intent;var paymentResource={returnUrl:"https://www.paypal.com/checkoutnow/error",cancelUrl:"https://www.paypal.com/checkoutnow/error",offerPaypalCredit:options.offerCredit===true,merchantAccountId:this._merchantAccountId,experienceProfile:{brandName:options.displayName||gatewayConfiguration.paypal.displayName,localeCode:options.locale,noShipping:(!options.enableShippingAddress).toString(),addressOverride:options.shippingAddressEditable===false,landingPageType:options.landingPageType}};if(options.flow==="checkout"){paymentResource.amount=options.amount;paymentResource.currencyIsoCode=options.currency;if(intent){if(intent==="capture"){intent="sale"}paymentResource.intent=intent}if(options.hasOwnProperty("lineItems")){paymentResource.lineItems=options.lineItems}for(key in options.shippingAddressOverride){if(options.shippingAddressOverride.hasOwnProperty(key)){paymentResource[key]=options.shippingAddressOverride[key]}}}else{paymentResource.shippingAddress=options.shippingAddressOverride;if(options.billingAgreementDescription){paymentResource.description=options.billingAgreementDescription}}return paymentResource};PayPalCheckout.prototype._formatTokenizeData=function(options,params){var clientConfiguration=this._configuration;var gatewayConfiguration=clientConfiguration.gatewayConfiguration;var isTokenizationKey=clientConfiguration.authorizationType==="TOKENIZATION_KEY";var data={paypalAccount:{correlationId:params.billingToken||params.ecToken,options:{validate:options.flow==="vault"&&!isTokenizationKey}}};if(params.billingToken){data.paypalAccount.billingAgreementToken=params.billingToken}else{data.paypalAccount.paymentToken=params.paymentId;data.paypalAccount.payerId=params.payerId;data.paypalAccount.unilateral=gatewayConfiguration.paypal.unvettedMerchant;if(options.intent){data.paypalAccount.intent=options.intent}}if(this._merchantAccountId){data.merchantAccountId=this._merchantAccountId}return data};PayPalCheckout.prototype._formatTokenizePayload=function(response){var payload;var account={};if(response.paypalAccounts){account=response.paypalAccounts[0]}payload={nonce:account.nonce,details:{},type:account.type};if(account.details&&account.details.payerInfo){payload.details=account.details.payerInfo}if(account.details&&account.details.creditFinancingOffered){payload.creditFinancingOffered=account.details.creditFinancingOffered}return payload};PayPalCheckout.prototype.teardown=function(){convertMethodsToError(this,methods(PayPalCheckout.prototype));return Promise.resolve()};module.exports=wrapPromise.wrapPrototype(PayPalCheckout)},{"../lib/analytics":9,"../lib/braintree-error":12,"../lib/convert-methods-to-error":14,"../lib/convert-to-braintree-error":15,"../lib/create-assets-url":16,"../lib/create-deferred-client":18,"../lib/methods":22,"../lib/promise":23,"../paypal/shared/constants":28,"./errors":25,"@braintree/wrap-promise":6}],28:[function(_dereq_,module,exports){"use strict";module.exports={LANDING_FRAME_NAME:"braintreepaypallanding",FLOW_ENDPOINTS:{checkout:"create_payment_resource",vault:"setup_billing_agreement"}}},{}]},{},[26])(26)});(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}(g.braintree||(g.braintree={})).dataCollector=f()}})(function(){var define,module,exports;return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(_dereq_,module,exports){(function(global){"use strict";var PromisePolyfill=_dereq_("promise-polyfill");module.exports=global.Promise||PromisePolyfill}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"promise-polyfill":7}],2:[function(_dereq_,module,exports){"use strict";var Promise=_dereq_("./lib/promise");var scriptPromiseCache={};function loadScript(options){var attrs,container,script,scriptLoadPromise;var stringifiedOptions=JSON.stringify(options);if(!options.forceScriptReload){scriptLoadPromise=scriptPromiseCache[stringifiedOptions];if(scriptLoadPromise){return scriptLoadPromise}}script=document.createElement("script");attrs=options.dataAttributes||{};container=options.container||document.head;script.src=options.src;script.id=options.id;script.async=true;Object.keys(attrs).forEach(function(key){script.setAttribute("data-"+key,attrs[key])});scriptLoadPromise=new Promise(function(resolve,reject){script.addEventListener("load",function(){resolve(script)});script.addEventListener("error",function(){reject(new Error(options.src+" failed to load."))});script.addEventListener("abort",function(){reject(new Error(options.src+" has aborted."))});container.appendChild(script)});scriptPromiseCache[stringifiedOptions]=scriptLoadPromise;return scriptLoadPromise}loadScript.clearCache=function(){scriptPromiseCache={}};module.exports=loadScript},{"./lib/promise":1}],3:[function(_dereq_,module,exports){"use strict";function deferred(fn){return function(){var args=arguments;setTimeout(function(){try{fn.apply(null,args)}catch(err){console.log("Error in callback function");console.log(err)}},1)}}module.exports=deferred},{}],4:[function(_dereq_,module,exports){"use strict";function once(fn){var called=false;return function(){if(!called){called=true;fn.apply(null,arguments)}}}module.exports=once},{}],5:[function(_dereq_,module,exports){"use strict";function promiseOrCallback(promise,callback){if(callback){promise.then(function(data){callback(null,data)}).catch(function(err){callback(err)})}else{return promise}}module.exports=promiseOrCallback},{}],6:[function(_dereq_,module,exports){"use strict";var deferred=_dereq_("./lib/deferred");var once=_dereq_("./lib/once");var promiseOrCallback=_dereq_("./lib/promise-or-callback");function wrapPromise(fn){return function(){var callback;var args=Array.prototype.slice.call(arguments);var lastArg=args[args.length-1];if(typeof lastArg==="function"){callback=args.pop();callback=once(deferred(callback))}return promiseOrCallback(fn.apply(this,args),callback)}}wrapPromise.wrapPrototype=function(target,options){var methods,ignoreMethods,includePrivateMethods;options=options||{};ignoreMethods=options.ignoreMethods||[];includePrivateMethods=options.transformPrivateMethods===true;methods=Object.getOwnPropertyNames(target.prototype).filter(function(method){var isNotPrivateMethod;var isNonConstructorFunction=method!=="constructor"&&typeof target.prototype[method]==="function";var isNotAnIgnoredMethod=ignoreMethods.indexOf(method)===-1;if(includePrivateMethods){isNotPrivateMethod=true}else{isNotPrivateMethod=method.charAt(0)!=="_"}return isNonConstructorFunction&&isNotPrivateMethod&&isNotAnIgnoredMethod});methods.forEach(function(method){var original=target.prototype[method];target.prototype[method]=wrapPromise(original)});return target};module.exports=wrapPromise},{"./lib/deferred":3,"./lib/once":4,"./lib/promise-or-callback":5}],7:[function(_dereq_,module,exports){"use strict";function finallyConstructor(callback){var constructor=this.constructor;return this.then(function(value){return constructor.resolve(callback()).then(function(){return value})},function(reason){return constructor.resolve(callback()).then(function(){return constructor.reject(reason)})})}var setTimeoutFunc=setTimeout;function noop(){}function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function Promise(fn){if(!(this instanceof Promise))throw new TypeError("Promises must be constructed via new");if(typeof fn!=="function")throw new TypeError("not a function");this._state=0;this._handled=false;this._value=undefined;this._deferreds=[];doResolve(fn,this)}function handle(self,deferred){while(self._state===3){self=self._value}if(self._state===0){self._deferreds.push(deferred);return}self._handled=true;Promise._immediateFn(function(){var cb=self._state===1?deferred.onFulfilled:deferred.onRejected;if(cb===null){(self._state===1?resolve:reject)(deferred.promise,self._value);return}var ret;try{ret=cb(self._value)}catch(e){reject(deferred.promise,e);return}resolve(deferred.promise,ret)})}function resolve(self,newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&(typeof newValue==="object"||typeof newValue==="function")){var then=newValue.then;if(newValue instanceof Promise){self._state=3;self._value=newValue;finale(self);return}else if(typeof then==="function"){doResolve(bind(then,newValue),self);return}}self._state=1;self._value=newValue;finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2;self._value=newValue;finale(self)}function finale(self){if(self._state===2&&self._deferreds.length===0){Promise._immediateFn(function(){if(!self._handled){Promise._unhandledRejectionFn(self._value)}})}for(var i=0,len=self._deferreds.length;i<len;i++){handle(self,self._deferreds[i])}self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled=typeof onFulfilled==="function"?onFulfilled:null;this.onRejected=typeof onRejected==="function"?onRejected:null;this.promise=promise}function doResolve(fn,self){var done=false;try{fn(function(value){if(done)return;done=true;resolve(self,value)},function(reason){if(done)return;done=true;reject(self,reason)})}catch(ex){if(done)return;done=true;reject(self,ex)}}Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected)};Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);handle(this,new Handler(onFulfilled,onRejected,prom));return prom};Promise.prototype["finally"]=finallyConstructor;Promise.all=function(arr){return new Promise(function(resolve,reject){if(!arr||typeof arr.length==="undefined")throw new TypeError("Promise.all accepts an array");var args=Array.prototype.slice.call(arr);if(args.length===0)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&(typeof val==="object"||typeof val==="function")){var then=val.then;if(typeof then==="function"){then.call(val,function(val){res(i,val)},reject);return}}args[i]=val;if(--remaining===0){resolve(args)}}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++){res(i,args[i])}})};Promise.resolve=function(value){if(value&&typeof value==="object"&&value.constructor===Promise){return value}return new Promise(function(resolve){resolve(value)})};Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})};Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++){values[i].then(resolve,reject)}})};Promise._immediateFn=typeof setImmediate==="function"&&function(fn){setImmediate(fn)}||function(fn){setTimeoutFunc(fn,0)};Promise._unhandledRejectionFn=function _unhandledRejectionFn(err){if(typeof console!=="undefined"&&console){console.warn("Possible Unhandled Promise Rejection:",err)}};module.exports=Promise},{}],8:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("../lib/braintree-error");module.exports={DATA_COLLECTOR_KOUNT_NOT_ENABLED:{type:BraintreeError.types.MERCHANT,code:"DATA_COLLECTOR_KOUNT_NOT_ENABLED",message:"Kount is not enabled for this merchant."},DATA_COLLECTOR_KOUNT_ERROR:{type:BraintreeError.types.MERCHANT,code:"DATA_COLLECTOR_KOUNT_ERROR"},DATA_COLLECTOR_REQUIRES_CREATE_OPTIONS:{type:BraintreeError.types.MERCHANT,code:"DATA_COLLECTOR_REQUIRES_CREATE_OPTIONS",message:"Data Collector must be created with Kount and/or PayPal."}}},{"../lib/braintree-error":15}],9:[function(_dereq_,module,exports){"use strict";var FRAUDNET_FNCLS=_dereq_("../lib/constants").FRAUDNET_FNCLS;var FRAUDNET_SOURCE=_dereq_("../lib/constants").FRAUDNET_SOURCE;var FRAUDNET_URL=_dereq_("../lib/constants").FRAUDNET_URL;var loadScript=_dereq_("../lib/assets").loadScript;var Promise=_dereq_("../lib/promise");var cachedSessionId;function setup(){var fraudNet=new Fraudnet;if(cachedSessionId){fraudNet.sessionId=cachedSessionId;return Promise.resolve(fraudNet)}return fraudNet.initialize()}function clearSessionIdCache(){cachedSessionId=null}function Fraudnet(){}Fraudnet.prototype.initialize=function(){var self=this;this.sessionId=cachedSessionId=_generateSessionId();this._beaconId=_generateBeaconId(this.sessionId);this._parameterBlock=_createParameterBlock(this.sessionId,this._beaconId);return loadScript({src:FRAUDNET_URL}).then(function(block){self._thirdPartyBlock=block;return self}).catch(function(){return null})};Fraudnet.prototype.teardown=function(){removeElementIfOnPage(document.querySelector('iframe[title="ppfniframe"]'));removeElementIfOnPage(document.querySelector('iframe[title="pbf"]'));removeElementIfOnPage(this._parameterBlock);removeElementIfOnPage(this._thirdPartyBlock)};function removeElementIfOnPage(element){if(element&&element.parentNode){element.parentNode.removeChild(element)}}function _generateSessionId(){var i;var id="";for(i=0;i<32;i++){id+=Math.floor(Math.random()*16).toString(16)}return id}function _generateBeaconId(sessionId){var timestamp=(new Date).getTime()/1e3;return"https://b.stats.paypal.com/counter.cgi"+"?i=127.0.0.1"+"&p="+sessionId+"&t="+timestamp+"&a=14"}function _createParameterBlock(sessionId,beaconId){var el=document.body.appendChild(document.createElement("script"));el.type="application/json";el.setAttribute("fncls",FRAUDNET_FNCLS);el.text=JSON.stringify({f:sessionId,s:FRAUDNET_SOURCE,b:beaconId});return el}module.exports={setup:setup,clearSessionIdCache:clearSessionIdCache}},{"../lib/assets":13,"../lib/constants":17,"../lib/promise":24}],10:[function(_dereq_,module,exports){"use strict";var kount=_dereq_("./kount");var fraudnet=_dereq_("./fraudnet");var BraintreeError=_dereq_("../lib/braintree-error");var basicComponentVerification=_dereq_("../lib/basic-component-verification");var createDeferredClient=_dereq_("../lib/create-deferred-client");var createAssetsUrl=_dereq_("../lib/create-assets-url");var methods=_dereq_("../lib/methods");var convertMethodsToError=_dereq_("../lib/convert-methods-to-error");var VERSION="3.45.0";var Promise=_dereq_("../lib/promise");var wrapPromise=_dereq_("@braintree/wrap-promise");var errors=_dereq_("./errors");function create(options){var name="Data Collector";var result={};var instances=[];var data;return basicComponentVerification.verify({name:name,client:options.client,authorization:options.authorization}).then(function(){return createDeferredClient.create({authorization:options.authorization,client:options.client,debug:options.debug,assetsUrl:createAssetsUrl.create(options.authorization),name:name})}).then(function(client){var kountInstance;var config=client.getConfiguration();if(options.kount===true){if(!config.gatewayConfiguration.kount){return Promise.reject(new BraintreeError(errors.DATA_COLLECTOR_KOUNT_NOT_ENABLED))}try{kountInstance=kount.setup({environment:config.gatewayConfiguration.environment,merchantId:config.gatewayConfiguration.kount.kountMerchantId})}catch(err){return Promise.reject(new BraintreeError({type:errors.DATA_COLLECTOR_KOUNT_ERROR.type,code:errors.DATA_COLLECTOR_KOUNT_ERROR.code,message:err.message}))}data=kountInstance.deviceData;instances.push(kountInstance)}else{data={}}return Promise.resolve()}).then(function(){if(options.paypal!==true){return Promise.resolve()}return fraudnet.setup().then(function(fraudnetInstance){if(fraudnetInstance){data.correlation_id=fraudnetInstance.sessionId;instances.push(fraudnetInstance)}})}).then(function(){if(instances.length===0){return Promise.reject(new BraintreeError(errors.DATA_COLLECTOR_REQUIRES_CREATE_OPTIONS))}result.deviceData=JSON.stringify(data);result.rawDeviceData=data;result.teardown=createTeardownMethod(result,instances);return result})}function createTeardownMethod(result,instances){return wrapPromise(function teardown(){return new Promise(function(resolve){instances.forEach(function(instance){if(instance){instance.teardown()}});convertMethodsToError(result,methods(result));resolve()})})}module.exports={create:wrapPromise(create),VERSION:VERSION}},{"../lib/basic-component-verification":14,"../lib/braintree-error":15,"../lib/convert-methods-to-error":18,"../lib/create-assets-url":19,"../lib/create-deferred-client":20,"../lib/methods":23,"../lib/promise":24,"./errors":8,"./fraudnet":9,"./kount":11,"@braintree/wrap-promise":6}],11:[function(_dereq_,module,exports){"use strict";var sjcl=_dereq_("./vendor/sjcl");var camelCaseToSnakeCase=_dereq_("../lib/camel-case-to-snake-case");var QA_URL="https://assets.qa.braintreepayments.com/data";var IFRAME_ID_PREFIX="braintreeDataFrame-";var environmentUrls={development:QA_URL,qa:QA_URL,sandbox:"https://assets.braintreegateway.com/sandbox/data",production:"https://assets.braintreegateway.com/data"};var cachedDeviceData={};function setup(o){var options=o!=null?o:{};return new Kount(options)}function Kount(options){var previouslyInitializedDeviceData=Kount.getCachedDeviceData(options.merchantId);if(previouslyInitializedDeviceData){this.deviceData=previouslyInitializedDeviceData;this._isCached=true;return}this._currentEnvironment=this._initializeEnvironment(options);sjcl.random.startCollectors();this._deviceSessionId=this._generateDeviceSessionId();this.deviceData=this._getDeviceData();Kount.setCachedDeviceData(options.merchantId,this.deviceData);this._iframe=this._setupIFrame()}Kount.getCachedDeviceData=function(merchantId){return cachedDeviceData[merchantId]};Kount.setCachedDeviceData=function(merchantId,data){cachedDeviceData[merchantId]=data};Kount.prototype.teardown=function(){if(!this._isCached){sjcl.random.stopCollectors();this._removeIframe()}};Kount.prototype._removeIframe=function(){this._iframe.parentNode.removeChild(this._iframe)};Kount.prototype._getDeviceData=function(){return camelCaseToSnakeCase({deviceSessionId:this._deviceSessionId,fraudMerchantId:this._currentEnvironment.id})};Kount.prototype._generateDeviceSessionId=function(){var bits,hexString;bits=sjcl.random.randomWords(4,0);hexString=sjcl.codec.hex.fromBits(bits);return hexString};Kount.prototype._setupIFrame=function(){var params,iframe;var self=this;params="?m="+this._currentEnvironment.id+"&s="+this._deviceSessionId;iframe=document.createElement("iframe");iframe.width=1;iframe.id=IFRAME_ID_PREFIX+this._deviceSessionId;iframe.height=1;iframe.frameBorder=0;iframe.scrolling="no";iframe.style.position="fixed";iframe.style.left="-999999px";iframe.style.top="-999999px";document.body.appendChild(iframe);setTimeout(function(){iframe.src=self._currentEnvironment.url+"/logo.htm"+params;iframe.innerHTML='<img src="'+self._currentEnvironment.url+"/logo.gif"+params+'" />'},10);return iframe};Kount.prototype._initializeEnvironment=function(options){var url=environmentUrls[options.environment];if(url==null){throw new Error(options.environment+" is not a valid environment for kount.environment")}return{url:url,name:options.environment,id:options.merchantId}};module.exports={setup:setup,Kount:Kount,environmentUrls:environmentUrls}},{"../lib/camel-case-to-snake-case":16,"./vendor/sjcl":12}],12:[function(_dereq_,module,exports){"use strict";var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};sjcl.cipher.aes=function(a){this.l[0][0][0]||this.G();var b,c,d,e,f=this.l[0][4],g=this.l[1];b=a.length;var k=1;if(4!==b&&6!==b&&8!==b)throw new sjcl.exception.invalid("invalid aes key size");this.b=[d=a.slice(0),e=[]];for(a=b;a<4*b+28;a++){c=d[a-1];if(0===a%b||8===b&&4===a%b)c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[c&255],0===a%b&&(c=c<<8^c>>>24^k<<24,k=k<<1^283*(k>>7));d[a]=d[a-b]^c}for(b=0;a;b++,a--)c=d[b&3?a:a-4],e[b]=4>=a||4>b?c:g[0][f[c>>>24]]^g[1][f[c>>16&255]]^g[2][f[c>>8&255]]^g[3][f[c&255]]};sjcl.cipher.aes.prototype={encrypt:function(a){return t(this,a,0)},decrypt:function(a){return t(this,a,1)},l:[[[],[],[],[],[]],[[],[],[],[],[]]],G:function(){var a=this.l[0],b=this.l[1],c=a[4],d=b[4],e,f,g,k=[],l=[],p,n,h,m;for(e=0;256>e;e++)l[(k[e]=e<<1^283*(e>>7))^e]=e;for(f=g=0;!c[f];f^=p||1,g=l[g]||1)for(h=g^g<<1^g<<2^g<<3^g<<4,h=h>>8^h&255^99,c[f]=h,d[h]=f,n=k[e=k[p=k[f]]],m=16843009*n^65537*e^257*p^16843008*f,n=257*k[h]^16843008*h,e=0;4>e;e++)a[e][f]=n=n<<24^n>>>8,b[e][h]=m=m<<24^m>>>8;for(e=0;5>e;e++)a[e]=a[e].slice(0),b[e]=b[e].slice(0)}};function t(a,b,c){if(4!==b.length)throw new sjcl.exception.invalid("invalid aes block size");var d=a.b[c],e=b[0]^d[0],f=b[c?3:1]^d[1],g=b[2]^d[2];b=b[c?1:3]^d[3];var k,l,p,n=d.length/4-2,h,m=4,q=[0,0,0,0];k=a.l[c];a=k[0];var r=k[1],v=k[2],w=k[3],x=k[4];for(h=0;h<n;h++)k=a[e>>>24]^r[f>>16&255]^v[g>>8&255]^w[b&255]^d[m],l=a[f>>>24]^r[g>>16&255]^v[b>>8&255]^w[e&255]^d[m+1],p=a[g>>>24]^r[b>>16&255]^v[e>>8&255]^w[f&255]^d[m+2],b=a[b>>>24]^r[e>>16&255]^v[f>>8&255]^w[g&255]^d[m+3],m+=4,e=k,f=l,g=p;for(h=0;4>h;h++)q[c?3&-h:h]=x[e>>>24]<<24^x[f>>16&255]<<16^x[g>>8&255]<<8^x[b&255]^d[m++],k=e,e=f,f=g,g=b,b=k;return q}sjcl.bitArray={bitSlice:function(a,b,c){a=sjcl.bitArray.M(a.slice(b/32),32-(b&31)).slice(1);return void 0===c?a:sjcl.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d=Math.floor(-b-c&31);return((b+c-1^b)&-32?a[b/32|0]<<32-d^a[b/32+1|0]>>>d:a[b/32|0]>>>d)&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c=a[a.length-1],d=sjcl.bitArray.getPartial(c);return 32===d?a.concat(b):sjcl.bitArray.M(b,d,c|0,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;return 0===b?0:32*(b-1)+sjcl.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(32*a.length<b)return a;a=a.slice(0,Math.ceil(b/32));var c=a.length;b=b&31;0<c&&b&&(a[c-1]=sjcl.bitArray.partial(b,a[c-1]&2147483648>>b-1,1));return a},partial:function(a,b,c){return 32===a?b:(c?b|0:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b))return!1;var c=0,d;for(d=0;d<a.length;d++)c|=a[d]^b[d];return 0===c},M:function(a,b,c,d){var e;e=0;for(void 0===d&&(d=[]);32<=b;b-=32)d.push(c),c=0;if(0===b)return d.concat(a);for(e=0;e<a.length;e++)d.push(c|a[e]>>>b),c=a[e]<<32-b;e=a.length?a[a.length-1]:0;a=sjcl.bitArray.getPartial(e);d.push(sjcl.bitArray.partial(b+a&31,32<b+a?c:d.pop(),1));return d},Y:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]},byteswapM:function(a){var b,c;for(b=0;b<a.length;++b)c=a[b],a[b]=c>>>24|c>>>8&65280|(c&65280)<<8|c<<24;return a}};sjcl.codec.utf8String={fromBits:function(a){var b="",c=sjcl.bitArray.bitLength(a),d,e;for(d=0;d<c/8;d++)0===(d&3)&&(e=a[d/4]),b+=String.fromCharCode(e>>>8>>>8>>>8),e<<=8;return decodeURIComponent(escape(b))},toBits:function(a){a=unescape(encodeURIComponent(a));var b=[],c,d=0;for(c=0;c<a.length;c++)d=d<<8|a.charCodeAt(c),3===(c&3)&&(b.push(d),d=0);c&3&&b.push(sjcl.bitArray.partial(8*(c&3),d));return b}};sjcl.codec.hex={fromBits:function(a){var b="",c;for(c=0;c<a.length;c++)b+=((a[c]|0)+0xf00000000000).toString(16).substr(4);return b.substr(0,sjcl.bitArray.bitLength(a)/4)},toBits:function(a){var b,c=[],d;a=a.replace(/\s|0x/g,"");d=a.length;a=a+"00000000";for(b=0;b<a.length;b+=8)c.push(parseInt(a.substr(b,8),16)^0);return sjcl.bitArray.clamp(c,4*d)}};sjcl.hash.sha256=function(a){this.b[0]||this.G();a?(this.u=a.u.slice(0),this.o=a.o.slice(0),this.h=a.h):this.reset()};sjcl.hash.sha256.hash=function(a){return(new sjcl.hash.sha256).update(a).finalize()};sjcl.hash.sha256.prototype={blockSize:512,reset:function(){this.u=this.K.slice(0);this.o=[];this.h=0;return this},update:function(a){"string"===typeof a&&(a=sjcl.codec.utf8String.toBits(a));var b,c=this.o=sjcl.bitArray.concat(this.o,a);b=this.h;a=this.h=b+sjcl.bitArray.bitLength(a);if(9007199254740991<a)throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!==typeof Uint32Array){var d=new Uint32Array(c),e=0;for(b=512+b-(512+b&511);b<=a;b+=512)u(this,d.subarray(16*e,16*(e+1))),e+=1;c.splice(0,16*e)}else for(b=512+b-(512+b&511);b<=a;b+=512)u(this,c.splice(0,16));return this},finalize:function(){var a,b=this.o,c=this.u,b=sjcl.bitArray.concat(b,[sjcl.bitArray.partial(1,1)]);for(a=b.length+2;a&15;a++)b.push(0);b.push(Math.floor(this.h/4294967296));for(b.push(this.h|0);b.length;)u(this,b.splice(0,16));this.reset();return c},K:[],b:[],G:function(){function a(a){return 4294967296*(a-Math.floor(a))|0}for(var b=0,c=2,d,e;64>b;c++){e=!0;for(d=2;d*d<=c;d++)if(0===c%d){e=!1;break}e&&(8>b&&(this.K[b]=a(Math.pow(c,.5))),this.b[b]=a(Math.pow(c,1/3)),b++)}}};function u(a,b){var c,d,e,f=a.u,g=a.b,k=f[0],l=f[1],p=f[2],n=f[3],h=f[4],m=f[5],q=f[6],r=f[7];for(c=0;64>c;c++)16>c?d=b[c]:(d=b[c+1&15],e=b[c+14&15],d=b[c&15]=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+b[c&15]+b[c+9&15]|0),d=d+r+(h>>>6^h>>>11^h>>>25^h<<26^h<<21^h<<7)+(q^h&(m^q))+g[c],r=q,q=m,m=h,h=n+d|0,n=p,p=l,l=k,k=d+(l&p^n&(l^p))+(l>>>2^l>>>13^l>>>22^l<<30^l<<19^l<<10)|0;f[0]=f[0]+k|0;f[1]=f[1]+l|0;f[2]=f[2]+p|0;f[3]=f[3]+n|0;f[4]=f[4]+h|0;f[5]=f[5]+m|0;f[6]=f[6]+q|0;f[7]=f[7]+r|0}sjcl.prng=function(a){this.c=[new sjcl.hash.sha256];this.i=[0];this.H=0;this.v={};this.F=0;this.J={};this.L=this.f=this.j=this.T=0;this.b=[0,0,0,0,0,0,0,0];this.g=[0,0,0,0];this.C=void 0;this.D=a;this.s=!1;this.B={progress:{},seeded:{}};this.m=this.S=0;this.w=1;this.A=2;this.O=65536;this.I=[0,48,64,96,128,192,256,384,512,768,1024];this.P=3e4;this.N=80};sjcl.prng.prototype={randomWords:function(a,b){var c=[],d;d=this.isReady(b);var e;if(d===this.m)throw new sjcl.exception.notReady("generator isn't seeded");if(d&this.A){d=!(d&this.w);e=[];var f=0,g;this.L=e[0]=(new Date).valueOf()+this.P;for(g=0;16>g;g++)e.push(4294967296*Math.random()|0);for(g=0;g<this.c.length&&(e=e.concat(this.c[g].finalize()),f+=this.i[g],this.i[g]=0,d||!(this.H&1<<g));g++);this.H>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.i.push(0));this.f-=f;f>this.j&&(this.j=f);this.H++;this.b=sjcl.hash.sha256.hash(this.b.concat(e));this.C=new sjcl.cipher.aes(this.b);for(d=0;4>d&&(this.g[d]=this.g[d]+1|0,!this.g[d]);d++);}for(d=0;d<a;d+=4)0===(d+1)%this.O&&y(this),e=z(this),c.push(e[0],e[1],e[2],e[3]);y(this);return c.slice(0,a)},setDefaultParanoia:function(a,b){if(0===a&&"Setting paranoia=0 will ruin your security; use it only for testing"!==b)throw new sjcl.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.D=a},addEntropy:function(a,b,c){c=c||"user";var d,e,f=(new Date).valueOf(),g=this.v[c],k=this.isReady(),l=0;d=this.J[c];void 0===d&&(d=this.J[c]=this.T++);void 0===g&&(g=this.v[c]=0);this.v[c]=(this.v[c]+1)%this.c.length;switch(typeof a){case"number":void 0===b&&(b=1);this.c[g].update([d,this.F++,1,b,f,1,a|0]);break;case"object":c=Object.prototype.toString.call(a);if("[object Uint32Array]"===c){e=[];for(c=0;c<a.length;c++)e.push(a[c]);a=e}else for("[object Array]"!==c&&(l=1),c=0;c<a.length&&!l;c++)"number"!==typeof a[c]&&(l=1);if(!l){if(void 0===b)for(c=b=0;c<a.length;c++)for(e=a[c];0<e;)b++,e=e>>>1;this.c[g].update([d,this.F++,2,b,f,a.length].concat(a))}break;case"string":void 0===b&&(b=a.length);this.c[g].update([d,this.F++,3,b,f,a.length]);this.c[g].update(a);break;default:l=1}if(l)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this.i[g]+=b;this.f+=b;k===this.m&&(this.isReady()!==this.m&&A("seeded",Math.max(this.j,this.f)),A("progress",this.getProgress()))},isReady:function(a){a=this.I[void 0!==a?a:this.D];return this.j&&this.j>=a?this.i[0]>this.N&&(new Date).valueOf()>this.L?this.A|this.w:this.w:this.f>=a?this.A|this.m:this.m},getProgress:function(a){a=this.I[a?a:this.D];return this.j>=a?1:this.f>a?1:this.f/a},startCollectors:function(){if(!this.s){this.a={loadTimeCollector:B(this,this.V),mouseCollector:B(this,this.W),keyboardCollector:B(this,this.U),accelerometerCollector:B(this,this.R),touchCollector:B(this,this.X)};if(window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,!1),window.addEventListener("mousemove",this.a.mouseCollector,!1),window.addEventListener("keypress",this.a.keyboardCollector,!1),window.addEventListener("devicemotion",this.a.accelerometerCollector,!1),window.addEventListener("touchmove",this.a.touchCollector,!1);else if(document.attachEvent)document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector);else throw new sjcl.exception.bug("can't attach event");this.s=!0}},stopCollectors:function(){this.s&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,!1),window.removeEventListener("mousemove",this.a.mouseCollector,!1),window.removeEventListener("keypress",this.a.keyboardCollector,!1),window.removeEventListener("devicemotion",this.a.accelerometerCollector,!1),window.removeEventListener("touchmove",this.a.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.s=!1)},addEventListener:function(a,b){this.B[a][this.S++]=b},removeEventListener:function(a,b){var c,d,e=this.B[a],f=[];for(d in e)e.hasOwnProperty(d)&&e[d]===b&&f.push(d);for(c=0;c<f.length;c++)d=f[c],delete e[d]},U:function(){C(this,1)},W:function(a){var b,c;try{b=a.x||a.clientX||a.offsetX||0,c=a.y||a.clientY||a.offsetY||0}catch(d){c=b=0}0!=b&&0!=c&&this.addEntropy([b,c],2,"mouse");C(this,0)},X:function(a){a=a.touches[0]||a.changedTouches[0];this.addEntropy([a.pageX||a.clientX,a.pageY||a.clientY],1,"touch");C(this,0)},V:function(){C(this,2)},R:function(a){a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z;if(window.orientation){var b=window.orientation;"number"===typeof b&&this.addEntropy(b,1,"accelerometer")}a&&this.addEntropy(a,2,"accelerometer");C(this,0)}};function A(a,b){var c,d=sjcl.random.B[a],e=[];for(c in d)d.hasOwnProperty(c)&&e.push(d[c]);for(c=0;c<e.length;c++)e[c](b)}function C(a,b){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?a.addEntropy(window.performance.now(),b,"loadtime"):a.addEntropy((new Date).valueOf(),b,"loadtime")}function y(a){a.b=z(a).concat(z(a));a.C=new sjcl.cipher.aes(a.b)}function z(a){for(var b=0;4>b&&(a.g[b]=a.g[b]+1|0,!a.g[b]);b++);return a.C.encrypt(a.g)}function B(a,b){return function(){b.apply(a,arguments)}}sjcl.random=new sjcl.prng(6);a:try{var D,E,F,G;if(G="undefined"!==typeof module&&module.exports){var H;try{H=_dereq_("crypto")}catch(a){H=null}G=E=H}if(G&&E.randomBytes)D=E.randomBytes(128),D=new Uint32Array(new Uint8Array(D).buffer),sjcl.random.addEntropy(D,1024,"crypto['randomBytes']");else if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){F=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(F);else if(window.msCrypto&&window.msCrypto.getRandomValues)window.msCrypto.getRandomValues(F);else break a;sjcl.random.addEntropy(F,1024,"crypto['getRandomValues']")}}catch(a){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(a))}"undefined"!==typeof module&&module.exports&&(module.exports=sjcl);"function"===typeof define&&define([],function(){return sjcl})},{crypto:undefined}],13:[function(_dereq_,module,exports){"use strict";var loadScript=_dereq_("@braintree/asset-loader/load-script");module.exports={loadScript:loadScript}},{"@braintree/asset-loader/load-script":2}],14:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("./braintree-error");var Promise=_dereq_("./promise");var sharedErrors=_dereq_("./errors");var VERSION="3.45.0";function basicComponentVerification(options){var client,authorization,name;if(!options){return Promise.reject(new BraintreeError({type:sharedErrors.INVALID_USE_OF_INTERNAL_FUNCTION.type,code:sharedErrors.INVALID_USE_OF_INTERNAL_FUNCTION.code,message:"Options must be passed to basicComponentVerification function."}))}name=options.name;client=options.client;authorization=options.authorization;if(client==null&&authorization==null){return Promise.reject(new BraintreeError({type:sharedErrors.INSTANTIATION_OPTION_REQUIRED.type,code:sharedErrors.INSTANTIATION_OPTION_REQUIRED.code,message:"options.client is required when instantiating "+name+"."}))}if(!authorization&&client.getVersion()!==VERSION){return Promise.reject(new BraintreeError({type:sharedErrors.INCOMPATIBLE_VERSIONS.type,code:sharedErrors.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+client.getVersion()+") and "+name+" (version "+VERSION+") components must be from the same SDK version."}))}return Promise.resolve()}module.exports={verify:basicComponentVerification}},{"./braintree-error":15,"./errors":22,"./promise":24}],15:[function(_dereq_,module,exports){"use strict";var enumerate=_dereq_("./enumerate");function BraintreeError(options){if(!BraintreeError.types.hasOwnProperty(options.type)){throw new Error(options.type+" is not a valid type.")}if(!options.code){throw new Error("Error code required.")}if(!options.message){throw new Error("Error message required.")}this.name="BraintreeError";this.code=options.code;this.message=options.message;this.type=options.type;this.details=options.details}BraintreeError.prototype=Object.create(Error.prototype);BraintreeError.prototype.constructor=BraintreeError;BraintreeError.types=enumerate(["CUSTOMER","MERCHANT","NETWORK","INTERNAL","UNKNOWN"]);BraintreeError.findRootError=function(err){if(err instanceof BraintreeError&&err.details&&err.details.originalError){return BraintreeError.findRootError(err.details.originalError)}return err};module.exports=BraintreeError},{"./enumerate":21}],16:[function(_dereq_,module,exports){"use strict";function transformKey(key){return key.replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1_$2").toLowerCase()}module.exports=function(obj){return Object.keys(obj).reduce(function(newObj,key){var transformedKey=transformKey(key);newObj[transformedKey]=obj[key];return newObj},{})}},{}],17:[function(_dereq_,module,exports){"use strict";var VERSION="3.45.0";var PLATFORM="web";var CLIENT_API_URLS={production:"https://api.braintreegateway.com:443",sandbox:"https://api.sandbox.braintreegateway.com:443"};var ASSETS_URLS={production:"https://assets.braintreegateway.com",sandbox:"https://assets.braintreegateway.com"};var GRAPHQL_URLS={production:"https://payments.braintree-api.com/graphql",sandbox:"https://payments.sandbox.braintree-api.com/graphql"};module.exports={ANALYTICS_PREFIX:PLATFORM+".",ANALYTICS_REQUEST_TIMEOUT_MS:2e3,ASSETS_URLS:ASSETS_URLS,CLIENT_API_URLS:CLIENT_API_URLS,FRAUDNET_SOURCE:"BRAINTREE_SIGNIN",FRAUDNET_FNCLS:"fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99",FRAUDNET_URL:"https://c.paypal.com/da/r/fb.js",GRAPHQL_URLS:GRAPHQL_URLS,INTEGRATION_TIMEOUT_MS:6e4,VERSION:VERSION,INTEGRATION:"custom",SOURCE:"client",PLATFORM:PLATFORM,BRAINTREE_LIBRARY_VERSION:"braintree/"+PLATFORM+"/"+VERSION}},{}],18:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("./braintree-error");var sharedErrors=_dereq_("./errors");module.exports=function(instance,methodNames){methodNames.forEach(function(methodName){instance[methodName]=function(){throw new BraintreeError({type:sharedErrors.METHOD_CALLED_AFTER_TEARDOWN.type,code:sharedErrors.METHOD_CALLED_AFTER_TEARDOWN.code,message:methodName+" cannot be called after teardown."})}})}},{"./braintree-error":15,"./errors":22}],19:[function(_dereq_,module,exports){"use strict";var ASSETS_URLS=_dereq_("./constants").ASSETS_URLS;function createAssetsUrl(authorization){return ASSETS_URLS.production}module.exports={create:createAssetsUrl}},{"./constants":17}],20:[function(_dereq_,module,exports){(function(global){"use strict";var BraintreeError=_dereq_("./braintree-error");var Promise=_dereq_("./promise");var assets=_dereq_("./assets");var sharedErrors=_dereq_("./errors");var VERSION="3.45.0";function createDeferredClient(options){var promise=Promise.resolve();if(options.client){return Promise.resolve(options.client)}if(!(global.braintree&&global.braintree.client)){promise=assets.loadScript({src:options.assetsUrl+"/web/"+VERSION+"/js/client.min.js"}).catch(function(err){return Promise.reject(new BraintreeError({type:sharedErrors.CLIENT_SCRIPT_FAILED_TO_LOAD.type,code:sharedErrors.CLIENT_SCRIPT_FAILED_TO_LOAD.code,message:sharedErrors.CLIENT_SCRIPT_FAILED_TO_LOAD.message,details:{originalError:err}}))})}return promise.then(function(){if(global.braintree.client.VERSION!==VERSION){return Promise.reject(new BraintreeError({type:sharedErrors.INCOMPATIBLE_VERSIONS.type,code:sharedErrors.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+global.braintree.client.VERSION+") and "+options.name+" (version "+VERSION+") components must be from the same SDK version."}))}return global.braintree.client.create({authorization:options.authorization,debug:options.debug})})}module.exports={create:createDeferredClient}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./assets":13,"./braintree-error":15,"./errors":22,"./promise":24}],21:[function(_dereq_,module,exports){"use strict";function enumerate(values,prefix){prefix=prefix==null?"":prefix;return values.reduce(function(enumeration,value){enumeration[value]=prefix+value;return enumeration},{})}module.exports=enumerate},{}],22:[function(_dereq_,module,exports){"use strict";var BraintreeError=_dereq_("./braintree-error");module.exports={INVALID_USE_OF_INTERNAL_FUNCTION:{type:BraintreeError.types.INTERNAL,code:"INVALID_USE_OF_INTERNAL_FUNCTION"},INSTANTIATION_OPTION_REQUIRED:{type:BraintreeError.types.MERCHANT,code:"INSTANTIATION_OPTION_REQUIRED"},INCOMPATIBLE_VERSIONS:{type:BraintreeError.types.MERCHANT,code:"INCOMPATIBLE_VERSIONS"},CLIENT_SCRIPT_FAILED_TO_LOAD:{type:BraintreeError.types.NETWORK,code:"CLIENT_SCRIPT_FAILED_TO_LOAD",message:"Braintree client script could not be loaded."},METHOD_CALLED_AFTER_TEARDOWN:{type:BraintreeError.types.MERCHANT,code:"METHOD_CALLED_AFTER_TEARDOWN"},BRAINTREE_API_ACCESS_RESTRICTED:{type:BraintreeError.types.MERCHANT,code:"BRAINTREE_API_ACCESS_RESTRICTED",message:"Your access is restricted and cannot use this part of the Braintree API."}}},{"./braintree-error":15}],23:[function(_dereq_,module,exports){"use strict";module.exports=function(obj){return Object.keys(obj).filter(function(key){return typeof obj[key]==="function"})}},{}],24:[function(_dereq_,module,exports){(function(global){"use strict";var Promise=global.Promise||_dereq_("promise-polyfill");module.exports=Promise}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"promise-polyfill":7}]},{},[10])(10)});
//# sourceMappingURL=https://www.coursehero.com/sym-assets/js/bundle-4871c0e-edac4bb.js.map